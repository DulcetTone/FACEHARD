' >>>>**** FACE-HARDENED ARMOR PENETRATION PROGRAM BY NATHAN OKUN ****<<<<
'              >>>>**** VERSION 8.0 OF 8 AUGUST 2018 ****<<<<
'      >>>>**** 2ND PRINT & SUBPROGRAM MODULE "FH80SBM2.BAS" ****<<<<
'
'  THE FOLLOWING MUST BE IDENTICAL AT TOP OF ALL MODULES OF THIS PROGRAM !!
'
COMMON SHARED NATION, PROJ, ARMR, SC, D, PENTP, OLDVALUE, NEWVALUE, CMT, VXP
COMMON SHARED Q, QDAM, UB, CARTWL, CMPND, SOFTSHAT, THNCHL, MSHAT, CRTGD, FLAG
COMMON SHARED TA, UBMAN, UBCALC, TPCAL, THIN, YS, MTLBACK, TRUTHIN, PSHMAX
COMMON SHARED TD, LCMOD, POLMOD, POIMOD, SHAT, CART, VS, OB, OBRAD, EX, EXRAD
COMMON SHARED VLMT, VLSHAT, VLTRU, VITRU, TOTPLUGWT, NORMPLUGWT, DELTAPLUGWT
COMMON SHARED UBSV, QSV, QDAMSV, CARTWLSV, CMPNDSV, THNCHLSV, SOFTSHATSV, HF
COMMON SHARED CRITAGL, SHATRES, NSDAMAGL, BRAAK, APCAP, LTCASE, PLIM, PDAM
COMMON SHARED ALD, BLD, CLD, AED, BED, CED, NDAP, BRK, NSBRK, BDYDM, BEND, WT
COMMON SHARED BKEFF, PNL, PNI, PNLSHAT, CARDONALD, PNLPR, VHSHAT, PENFLG, VLND
COMMON SHARED VDFSTD, VDFUSED, VDFSTDWW1, VDFSTDWW2, VSCRIT, CAPHD, OBCRIT, WB
COMMON SHARED VHOL, WTSAVE, BRAIK, VDFBND, VDFBRK, MAXDIFF, SNCSMAX, OBDF, MO
COMMON SHARED THKTHN, THKTHNSV, MINEV, MINEV1, MINEV2, MINEV3, MINEV4, MINEV5
COMMON SHARED NVRFLAG, MAXOB, THVAL, THSPD, HARD, WD, VHTRU, CRTAPR, MTMP, VR
COMMON SHARED CURV, CRVRL, CRVFLAG, VRATMIN, VHEXREV, VLEXREV, VHDAM, VLDAM
COMMON SHARED VRAT, VRATVEL, EXMIN, TMPOBDF, NSSHAT, VNPLUG, VDPLUG, VRSHATNS
COMMON SHARED OB45, OB45CALC, VHSHATMAX, VLSHATMAX, CRITVEL, SHATVDF, NOTEFLAG
COMMON SHARED VDFUSEDPR, VRPR, VHND, EXTH, OBRK, TCAL, NSTEST, NSTESTV, SAMPRJ
COMMON SHARED OPRIMEL, OPRIMED, OBPRNT, EXPRNT, MTMPCR, MTMPNS, VCNT, SWAPFLG
COMMON SHARED WTSVPRNT, WTPRNT, WBPRNT, SOFTQPMAX, MINSHVEL, PENCONST#, TEFF
COMMON SHARED SHATMULT, VTOTAL, UBFLAG, VDFHARVEY, SHATPRT, SAMEPLATE, VSCHECK
COMMON SHARED NBL1$, NBL2$, NBL3$, NBL4$, NBL5$, NBL6$, NBL7$, RESNOTE$, PSL$
COMMON SHARED HBL1$, HBL2$, HBL3$, HBL4$, HBL5$, HBL6$, HBL7$, HBL8$, HBL9$, ND$
COMMON SHARED PAND$, FLAKE$, CAP$, REMV$, NOTE1$, NOTE2$, NOTE3$, NOTE4$, NOTE5$
COMMON SHARED BDYDM1$, BDYDM2$, BDYDM3$, NSBRK1$, NSBRK2$, NSBRK3$, BD1$, BD2$
COMMON SHARED BKPRT1$, BKPRT2$, BKPRT3$, BKPRT4$, BKPRT5$, CALC$, EBL$, EFFVEL$
COMMON SHARED HBLTONBL$, N1$, N2$, N3$, N4$, H1$, H2$, H3$, H4$, PRJ$, NATN$
COMMON SHARED VELLTRU$, VELLSHAT$, VELLSHATMAX$, VELLND$, EFFPRINT1$, BDYDM4$
COMMON SHARED VELHTRU$, VELHSHAT$, VELHSHATMAX$, VELHND$, EFFPRINT2$, BDYDM5$
COMMON SHARED YS$, PEN1$, PEN2$, WBL1$, WBL2$, WBL3$, WBL4$, VEL$, NOTE5A$
COMMON SHARED ONEPC$, RVU$, DPLG$, REMVEL$, BSNS1$, BSNS2$, BSNS3$, NOTE5B$
COMMON SHARED TWOVEL$, AMPER$, NOPLG$, PEN3$, SHATVDFPR, VLTRUWK
DIM SHARED M(15), MS(17)
COMMON M(), MS()
'
' ** END OF MODULE-LEVEL "FH80SBM2.BAS" CODE **

SUB BACKPRINT STATIC
'
' PRINT METAL BACKING LAYER TYPES
'
PRINT : PRINT "Select general type of backing plate from the following table:": PRINT
BKNGT1$ = "Wrought Iron": BKNGQ1$ = " (Q = 0.6)"
BKNG1$ = BKNGT1$ + "                                                   " + BKNGQ1$: BKPRT1$ = BKNGT1$ + BKNGQ1$
BKNGT2$ = "Mild (Medium) Steel thru WWI": BKNGQ2$ = " (Q = 0.7)"
BKNG2$ = BKNGT2$ + "                                   " + BKNGQ2$: BKPRT2$ = BKNGT2$ + BKNGQ2$
BKNGT3$ = "High Tensile Steel thru WWI, Nickel Steel, Post-WWI Mild Steel": BKNGQ3$ = " (Q = 0.8)"
BKNG3$ = BKNGT3$ + " " + BKNGQ3$: BKPRT3$ = BKNGT3$ + BKNGQ3$
BKNGT4$ = "Post-WWI High Tensile Steel & British/Japanese Ducol (D) Steel": BKNGQ4$ = " (Q = 0.9)"
BKNG4$ = BKNGT4$ + " " + BKNGQ4$: BKPRT4$ = BKNGT4$ + BKNGQ4$
BKNGT5$ = "All Special Treatment (homogeneous Krupp-armor grade) Steels": BKNGQ5$ = " (Q = 1.0)"
BKNG5$ = BKNGT5$ + "   " + BKNGQ5$: BKPRT5$ = BKNGT5$ + BKNGQ5$
PRINT " 1. " + BKNG1$: PRINT " 2. " + BKNG2$: PRINT " 3. " + BKNG3$
PRINT " 4. " + BKNG4$: PRINT " 5. " + BKNG5$
PRINT
'
'  ** END OF SUB BACKPRINT **
'
END SUB

SUB CHGARMRPRNT STATIC
'
' PRINT A MESSAGE IF ARMOR HAS HAD ANY DEFAULT VALUES CHANGED BY USER.
'
PRINT
ARMRCHGD = 0
IF ((ARMR = 1) OR (ARMR = 3) OR (ARMR = 4) OR (ARMR = 15)) THEN
  IF (UBMAN > 0) THEN ARMRCHGD = 1
ELSE
  IF (UB <> UBSV) THEN ARMRCHGD = 1
END IF
IF ((QSV <> Q) OR (QDAMSV <> QDAM)) THEN
   ARMRCHGD = 1
ELSEIF ((CARTWLSV <> CARTWL) OR (CMPNDSV <> CMPND)) THEN
   ARMRCHGD = 1
ELSEIF ((THNCHLSV <> THNCHL) OR (SOFTSHATSV <> SOFTSHAT)) THEN
   ARMRCHGD = 1
ELSEIF (THKTHNSV <> THKTHN) THEN
   ARMRCHGD = 1
END IF
IF (ARMRCHGD = 1) THEN
  PRINT "ARMOR HAS BEEN CHANGED FROM DEFAULT PARAMETERS.  USER-ENTERED CHANGES"
  PRINT "ARE ONLY PRESERVED FOR NEXT IMPACT IF PLATE TYPE & THICKNESS UNCHANGED."
END IF
'
'  ** END OF SUB CHGARMRPRNT **
END SUB

SUB DAMAGESETUP STATIC
'
' SET UP TO PRINT PROJECTILE DAMAGE MESSAGES
'
'**
'HARVEY ARMOR VS MIDVALE PRE-UNBREAKABLE TOUGH-STEEL PROJ
SUBEND = 0
IF (NSBRK = 8) THEN
  EFFPRINT1$ = " HOLING BL (TOUGH PROJ VS HARVEY ARMOR)"
  SUBEND = 1
END IF
IF (SUBEND = 1) THEN EXIT SUB
'**
'
IF ((CRVFLAG = 1) AND ((MINEV <= 0) OR (MINEV >= VHOL))) THEN
'NOTE: IF NOT TRUE, THEN PROJ ALREADY EFFECTIVE WHEN CURVED-PLATE RULE BEGINS AT HBL (SKIP LOGIC)
'CURVED-PLATE RULE APPLIED
  IF ((MINEV = 0) OR (MINEV1 = -1) OR (MINEV3 = -1)) THEN
    MINEV = 0: NOTEFLAG = 2: 'REGULAR CURVED-PLATE RULE FORCES NOSE-ONLY SHATR
  ELSEIF ((MINEV > VHOL) AND (MINEV <= VLMT)) THEN
    NOTEFLAG = 3: 'CURVED-PLATE RULE LOWERS EFFECTIVE LIMIT TO HBL
  ELSEIF (MINEV > VLMT) THEN
    NOTEFLAG = 4: 'GAP EXISTS BETWEEN EFFECTIVE LIMIT AND CURVED-PLATE RULE VEL REGION
  END IF
END IF
'
IF (LTCASE > 0) THEN
'LARGE-CAVITY PROJ
  IF (SHAT = 1) THEN
    EFFPRINT1$ = " NEVER (NOSE SHATTER REACHES CAVITY)"
    GOTO SOFTSHATRULE: 'NOSE-ONLY SHATR DOES NOT PREVENT CAVITY DAMAGE OF A LIGHTCASE PROJ
  END IF
  IF ((MINEV2 > 0) AND (MINEV = MINEV2)) THEN
    NSFLG = 1: NOTEFLAG = 0: 'ALL NOSE BREAKAGE OF A LIGHTCASE PROJ CAUSES LOSS OF EFFECTIVENESS
  END IF
END IF
'*
'EFFECTIVE PROJ
'
IF (NOTEFLAG >= 2) THEN
'CURVED-PLATE RULE
  IF (NOTEFLAG = 4) THEN
    EFFVEL$ = VEL$
    IF (VHOL <= 4000) THEN PAND$ = " *AND*"
  END IF
  IF (((NOTEFLAG = 2) OR (NOTEFLAG = 4)) AND (VHOL <= 4000)) THEN
    HBLTONBL$ = " BETWEEN HOLING BL & NAVY BL (SEE BELOW)"
    GOTO CRVPLATERULE: 'REGULAR RULE USE
  END IF
END IF
'
IF (NOTEFLAG = 3) THEN
  MINEV = VHOL: 'MIN EFFECTIVE LIMIT LOWERED TO HBL BY CURVED-PLATE RULE
ELSE
  IF ((MINEV = 0) AND (MINEV1 <> -1) AND (MINEV3 <> -1)) THEN
    EFFPRINT1$ = " USUALLY EFFECTIVE (CAVITY IMMUNE TO NOSE DAMAGE)"
    GOTO SOFTSHATRULE
  END IF
END IF
'
IF ((MINEV = 0) AND (MINEV1 = -1)) THEN
  EFFPRINT1$ = " NEVER (COMPLETE SHATTER)"
  GOTO ENDSPG: 'EXIT
END IF
'
IF (MINEV3 = -1) THEN
  NVRFLAG = 1
  EFFPRINT1$ = " RARELY EFFECTIVE.  EXCEEDS BREAKAGE ANGLE (DEGREES):"
  GOTO ENDSPG: 'EXIT
END IF
'
IF ((HARD = -1) AND (SHATRES < 2) AND (MINEV <= VLMT)) THEN
  EFFPRINT1$ = " NAVY BL"
  NVRFLAG = 0: NSFLG = 1
ELSEIF ((MINEV <> VLMT) AND (MINEV > VHOL)) THEN
  EFFVEL$ = VEL$
ELSE
  IF (MINEV = VLMT) THEN
    EFFPRINT1$ = " NAVY BL"
  ELSE
    EFFPRINT1$ = " HOLING BL"
    IF (NOTEFLAG = 3) THEN
      EFFPRINT2$ = " (DUE TO CURVED PLATE) (SEE BELOW)"
      GOTO CRVPLATERULE
    END IF
  END IF
END IF
'
IF (NVRFLAG = 0) AND (NSFLG = 1) THEN EFFPRINT2$ = " (NOSE DAMAGE REACHES CAVITY)"
'
GOTO SOFTSHATRULE
'*
CRVPLATERULE:
' PRINT OUT CURVE PLATE RULE ON SCREEN OR ON PAPER WHEN IT APPLIES
'
NOTE1$ = "SPECIAL CURVED-PLATE RULE FOR BODY DAMAGE:"
NOTE2$ = " Strong steel projectiles frequently remain effective against curved plates at"
NOTE3$ = " over 45 degrees obliquity if Striking Velocity is between Holing BL & Navy BL."
IF (SHAT = 1) THEN
  NOTE4$ = " Complete shatter of this projectile will occur otherwise."
ELSEIF (BEND = 1) AND (OB >= OBCRIT) AND (CARDONALD = 0) THEN
  NOTE4$ = " Complete breakup of this projectile will occur otherwise."
ELSE
  IF (MINEV = VHOL) THEN
    NOTE4$ = " Other effects keep projectile effective above Navy BL."
  END IF
END IF
'*
GOTO ENDSPG: 'EXIT
'*
SOFTSHATRULE:
IF (NOTEFLAG = 1) THEN
  IF (HARD = 1) THEN
    NOTE1$ = "SPECIAL SOFT CAP & EXTRA-TOUGH PLATE NOSE-ONLY SHATTER RULE:"
  ELSE
    NOTE1$ = "SPECIAL HOOD & NOT-EXTRA-TOUGH PLATE NOSE-ONLY SHATTER RULE:"
  END IF
  NOTE2$ = "Nose-only shatter if Complete Penetration @ OB<=15deg, sometimes if 15<OB<20deg."
  NOTE3$ = "Complete shatter of this projectile against this armor will occur otherwise."
END IF
'*
ENDSPG:
' ** END OF SUB DAMAGESETUP **
END SUB

SUB DOCRTGOOD STATIC
' DO 'CRTGD' PASS-CRTAPR-CHECK LOGIC
'
IF ((NSBRK > 0) OR (PENFLG = 2)) THEN
'*
  IF ((CRTAPR <= 0) OR ((CRTAPR > 0) AND ((OB - EX) >= CRTAPR)) OR ((SHAT = 1) AND (HARD <> 2))) THEN GOTO SKIPVMOD: 'TEST FAILED
'*
  CRTGD = 1: 'PERFORMED & PASSED 'CRITAGL'/'NSDAMAGL' COMBINED TEST
'*
'MUST REVISE REMAINING VELOCITY CALC IF 'CRITAGL'/'NSDAMAGL' COMBINED TEST PASSED
  VHDAM = VHND: VLDAM = VLND
  IF (VHDAM > VHSHATMAX) THEN
    VHDAM = VHSHATMAX
  END IF
  IF (SHAT = 1) THEN
'JAP UNCAPPED TYPE 91 AP W/CAP HEAD IN PLACE
    VLDAM = VLSHATMAX
  END IF
  IF (H1$ = "-!#-") THEN
    H4$ = "-#-": H1$ = "-!-": ''VHND' REPLACES 'VHOL' FOR POST-IMPACT CALC
  ELSEIF (H2$ = "-!#-") THEN
    H3$ = "-#-": H2$ = "-!-": ''VHSHATMAX' REPLACES 'VHOL' FOR POST-IMPACT CALC
  END IF
  IF (N1$ = "-!#-") THEN
    N4$ = "-#-": N1$ = "-!-": ''VLND' REPLACES 'VLMT' FOR POST-IMPACT CALC
  ELSEIF (N2$ = "-!#-") THEN
    N3$ = "-#-": N2$ = "-!-": ''VLSHATMAX' REPLACES 'VLMT' FOR POST-IMPACT CALC
  END IF
SKIPVMOD:
ELSE
  CRTGD = 1: ''CRITAGL'/'NSDAMAGL' COMBINED TEST NOT DONE & LOWER BODY ASSUMED OK
END IF
'
IF ((PENFLG > 0) AND (CRTGD = 0)) THEN BRK = 4
'
' ** END OF SUB DOCRTGOOD **
END SUB

SUB FACECALC STATIC

' CALCULATE VARIABLE BACK LAYER THICKNESS (UB) FOR GRUSON CHILLED CAST IRON,
' HARVEY ARMOR (BOTH TYPES), & WWII ITALIAN TERNI CEMENTED ARMORS

IF (ARMR = 1) THEN
' GRUSON ARMOR
  IF (TA <= 15.75) THEN
    UBCALC = 45: 'MINIMUM BACKING LAYER THICKNESS
  ELSEIF (TA >= 33.07) THEN
    UBCALC = 67: 'THICKEST PLATE KNOWN (84CM) W/MAX BACK LAYER THICKNESS
  ELSE
    UBCALCTMP = 45 + 22 * (TA - 15.75) / 17.32: 'LINEAR INCREASE FROM 45% TO 67% DUCTILE BACK ASSUMED
    UBCALC = INT(UBCALCTMP): 'MATCH INTERNAL VALUE TO DISPLAYED VALUE (ROUND DOWN TO WHOLE NUMBER)
  END IF
ELSEIF ((ARMR = 3) OR (ARMR = 4)) THEN
' HARVEYIZED STEEL (#3 = MILD STEEL & #4 = NICKEL-STEEL)
  UBCALCTMP = 100 * (1 - (1.25 / TA)): 'FIXED 1-1.5" FACE LAYER THICKNESS (USE AVERAGE)
  UBCALC = INT(UBCALCTMP): 'MATCH INTERNAL VALUE TO DISPLAYED VALUE (ROUND DOWN TO WHOLE NUMBER)
ELSE
' TERNI ARMOR
  IF (TA < 6.2205) THEN
    UBCALC = 50: 'BB SECONDARY GUN MOUNTS & OTHER LIGHT ARMOR (13CM = 5.1181" PLATE KNOWN)
  ELSEIF (TA > 10.433) THEN
    UBCALC = 70: 'BB BELT & BARBETTE/TURRET/CONNING TOWER & OTHER HEAVY ARMOR (28CM = 11.0236" PLATE KNOWN)
  ELSE
' SHAPE OF FACE THICKNESS CURVE BETWEEN 13CM & 28CM NOT KNOWN.  ASSUME SIMPLEST CURVE THAT DOES NOT CAUSE 
'   PROBLEMS (STRAIGHT RAMP).
    FACE = 3.1102 + (.004682) * (TA - 6.2205):   'VALUES USED PREVENT ERROR AT EITHER 50 OR 70 BOUNDARY
    UBCALCTMP = 100 * (1 - (FACE / TA)): 'ALL INTERMEDIATE PLATES (NEARLY CONSTANT FACE THICKNESS)
    UBCALC = INT(UBCALCTMP): 'MATCH INTERNAL VALUE TO DISPLAYED VALUE (ROUND DOWN TO WHOLE NUMBER)
  END IF
END IF

' ** END OF SUB FACECALC **

END SUB

SUB GETPLATETHICKNESS STATIC

' INPUT AND STORE ACTUAL PLATE THICKNESS (TA)

THICKNESS:
IF (TA > 0) THEN PRINT "CURRENT ACTUAL PLATE THICKNESS ="; TA; "inches"
INPUT "Armor plate actual thickness at impact center (TA), inches: ", TA$
IF ((TA$ = "") AND (TA > 0)) THEN
  PRINT "Using"; TA
  SAMEPLATE = 2
ELSE
  TATEST = TA: TA = VAL(TA$)
  IF (TATEST = TA) THEN SAMEPLATE = 2
END IF
IF (TA <= 0) THEN SAMEPLATE = 0: GOTO THICKNESS: 'BAD INPUT

'  ** END OF SUB GETPLATETHICKNESS **

END SUB

SUB GETPROJDWTWB STATIC
'
' PRINT OLD D, WT, WB AND ASK USER FOR NEW VALUES.  SET/CLEAR 'CAPHD' FLAG
IF (D > 0) THEN
  PRINT "CURRENT PROJECTILE DIAMETER ="; D; "inch";
  IF (D > 1!) THEN PRINT "es":  ELSE PRINT
END IF
DIAMETER:
INPUT "Projectile diameter (D), inches: ", PRJD$
IF ((PRJD$ = "") AND (D > 0)) THEN
  PRINT "Using"; D
ELSE
  D = VAL(PRJD$)
END IF
IF (D <= 0) THEN GOTO DIAMETER: 'BAD INPUT
IF (WTSAVE > 0) THEN
  PRINT "CURRENT PROJECTILE TOTAL WEIGHT ="; WTSAVE; "pound";
  IF (WTSAVE > 1!) THEN PRINT "s":  ELSE PRINT
END IF

TOTALWT:
INPUT "Projectile total weight (WT), pounds: ", WT$
IF ((WT$ = "") AND (WTSAVE > 0)) THEN
  PRINT "Using"; WTSAVE: WT = WTSAVE
ELSE
  WT = VAL(WT$): WTSAVE = WT
END IF
IF (WT <= 0) THEN GOTO TOTALWT: 'BAD INPUT

CAPHD = 0: 'RESET 'CAP HEAD' FLAG
IF ((NATION = 6) AND (PROJ >= 8)) THEN
'JAP TYPE 88/91 AP/APC PROJ W/'CAP HEAD' LOGIC: UNCAPPED(AP)=10 & CAPPED(APC)=8 & 9
  IF (PROJ = 10) THEN
    CAPHD = 1: 'UNCAPPED 15.5/20.3CM TYPE 91 AP (20CM TYPE 88 HAS AP CAP, I THINK)
    PRINT "'CAP HEAD' IS NOT PART OF BODY BECAUSE IT SHATTERS BEFORE NOSE DOES."
  ELSE
    CAPHD = 2: 'CAPPED TYPE 88/91/1 AP
  END IF
END IF
IF (WB > 0) THEN
  PRINT "CURRENT PROJECTILE BODY WEIGHT ="; WB; "pound";
  IF (WB > 1!) THEN PRINT "s":  ELSE PRINT
END IF

BODYWT:
INPUT "Projectile body weight (WB), pounds (Maximum=WT & Minimum=WT/2): ", WB$
IF ((WB$ = "") AND (WB >= WT / 2) AND (WB <= WT)) THEN
  PRINT "Using"; WB
ELSE
  WB = VAL(WB$)
END IF
IF ((WB < (WT / 2)) OR (WB > WT)) THEN GOTO BODYWT: 'BAD INPUT

PRINT
'ALWAYS COMPUTE SOFT CAP OR HOOD EXTRA ENERGY LOSS EVEN IF NOT USED
SOFTQPTMP = 1! - (1.1 * ((WT - WB) / WT) - .0268): 'MAXIMUM QUALITY FOR SOFT-CAPPED OR HOODED PROJ
SOFTQPTEMP = INT(1000 * SOFTQPTMP + .5): SOFTQPMAX = SOFTQPTEMP / 1000
IF (SOFTQPMAX > 1!) THEN SOFTQPMAX = 1!: 'QUALITY CANNOT BE IMPROVED BY A SMALL SOFT CAP OR HOOD
'
' ** END SUB GETPROJDWTWB **

END SUB

SUB GRSNHRVYTC STATIC

' GRUSON (ARMR = 1) OR HARVEY (ARMR = 3 OR 4) OR TERNI CEMENTED (ARMR = 15)
' ARMOR FACE THICKNESS LOGIC
'
PRINT
IF (ARMR = 1) THEN
  PRINT "Gruson Armor Back Layer Percent (UB) varies linearly (estimate) from a minimum"
  PRINT "of 45% if TA <= 15.75 inches to a maximum of 67% if TA >= 33.07 inches (84cm,"
  PRINT "the thickest known Gruson plate ever made)."
ELSEIF ((ARMR = 3) OR (ARMR = 4)) THEN
  PRINT "Harveyized Armor (Mild Steel or Ni-Steel) has thin (1-1.5-inch) 'Cemented' face"
  PRINT "layer made by carburizing the face against hot charcoal or flaming natural gas"
  PRINT "for a couple of weeks & then chilling that face so only it gets very hard while"
  PRINT "the rest of the plate is not changed much.  Limited shatter-causing ability."
ELSE
  PRINT "Terni Cemented Armor Back Layer Percent (UB) varies linearly (estimate) from a"
  PRINT "minimum of 50% if TA < 6.2205 inches to a maximum of 70% if TA > 10.433 inches."
  PRINT "Between these two boundaries, face thickness is very close to constant for all"
  PRINT "plate thicknesses.  The simplest estimate between known 13cm & 28cm TC plates."
END IF
PRINT "UB values calculated are rounded down to the nearest whole percent."
PRINT "  CURRENT PLATE BACK LAYER FROM 'UB' DEFAULT CALCULATION (%) ="; UBCALC
PRINT "  CURRENT MANUAL 'UB' OVERRIDE VALUE (%) =";
IF (UBMAN <> 0) THEN PRINT UBMAN:  ELSE PRINT " NONE (Default value in use)"
'

' ** END OF SUB GRUSONANDTC **

END SUB

SUB IMPACTPRNT STATIC

' PRINT PROJ IMPACT INFORMATION

PRINT "Projectile Diameter (Caliber)   ="; D; "inches -- Nation ="; NATION; "& Type ="; PROJ
PRINT "Projectile Striking Velocity    ="; VS; "ft/sec"
OBPRNT = INT(100 * OB + .5) / 100: EXPRNT = INT(100 * EX + .5) / 100
PRINT "Angles, degrees:  Obliquity     ="; OBPRNT; "& Exit =";
IF (EX >= 0) THEN PRINT EXPRNT:  ELSE PRINT " NOT DEFINED"

' NOSE COVERING LOSS INFO

IF (WB = WTSAVE) THEN
  REMV$ = "Projectile does not use any nose coverings by design."
ELSEIF (WT = WTSAVE) THEN
  REMV$ = "All projectile nose coverings intact and in place on impact."
ELSEIF (WT = WB) THEN
  REMV$ = "All projectile nose coverings stripped off by prior impact."
ELSEIF (CAPHD > 0) THEN
'PROJ WT ABOVE WB BUT BELOW ORIGINAL WT & SHELL HAS CAP HEAD (WINDSCREEN LOSS
'  ALWAYS TAKES CAP HEAD WITH IT)
  REMV$ = "Windscreen and Cap Head stripped off by prior impact.  AP cap intact."
ELSE
'PROJ WT ABOVE WB (SOMETHING STILL ON NOSE) BUT BELOW ORIGINAL WT (SOMETHING
'  WAS REMOVED PRIOR TO IMPACT) & SHELL HAS NO CAP HEAD
  IF (APCAP < 0) THEN CAP$ = "  Hood intact.":  ELSE CAP$ = "  AP cap intact."
  REMV$ = "Windscreen stripped off by prior impact." + CAP$
END IF

PRINT REMV$

WTSVPRNT = INT(100 * WTSAVE + .5) / 100: WTPRNT = INT(100 * WT + .5) / 100
WBPRNT = INT(100 * WB + .5) / 100
PRINT "Projectile Weights, pounds: Original="; WTSVPRNT; "*Impact="; WTPRNT; "*Body="; WBPRNT

'  ** END OF SUB IMPACTPRNT **

END SUB

SUB MINEVSHATCALC STATIC

' SHATR MINIMUM EFFECTIVE VELOCITY SORTING CALCULATION

IF (NSSHAT = 0) OR ((NSSHAT > 0) AND (LTCASE > 1)) THEN
' COMPLETE SHATR OR ANY SHATR OF LARGE-CAVITY (LIGHTCASE) PROJ
  MINEV1 = -1: ' COMPLETE SHATR FLAG
  NOTEFLAG = 0: ' NO-OP
ELSEIF (NSSHAT = 1) THEN
' NOSE-ONLY SHTR DUE TO SOFT CAP ON SOFTSHAT ARMOR
  MINEV1 = VLMT: ' PROJ BODY UNBROKEN AT SHATRD NBL
  NOTEFLAG = 1: ' SOFT CAP AND HOOD SHATR VS SOFTSHAT ARMOR
ELSEIF (NSSHAT = 2) THEN
' NOSE-ONLY SHATR DUE TO LOW IMPACT VEL
  MINEV1 = VHOL: ' PROJ USUALLY BREAKS UP WHEN NO HOLE MADE
  NOTEFLAG = 0: ' NO-OP
ELSEIF (NSSHAT = 3) THEN
' CURVED-PLATE RULE IN FORCE
  MINEV1 = -1: ' COMPLETE SHTR & CURVED-PLATE RULE FLAG
  NOTEFLAG = 0: ' NO-OP
ELSEIF (NSSHAT = 4) THEN
' NOSE-ONLY SHTR DUE TO HOOD ON NON-SOFTSHAT ARMOR
  MINEV1 = VLMT: ' PROJ UNBROKEN AT SHATRD NBL
  NOTEFLAG = 1: ' SOFT CAP AND HOOD SHATR VS SOFTSHAT ARMOR
END IF

' ** END OF SUB MINEVSHATCALC **

END SUB

SUB MODIFYVDF STATIC

' CHANGE THE HBL-TO-NBL VELOCITY RANGE FOR SPECIAL CASES

'DAMAGED-PROJ HBL ('VLTRU' IF NOT 'VHND') IS REPLACED BY 'VHSHAT' IF THIS HBL > 'VHSHAT'
'UNDAMAGED-PROJ HBL ('VLND') IS REPLACED BY 'VHSHATMAX' IF THIS HBL > 'VHSHATMAX'
'STANDARD WWI "15% THICKNESS DIFFERENCE RULE":  PLATE'S HBL = NBL OF A PLATE 15% THINNER;
'WWII PLATES ARE USUALLY MUCH TOUGHER & HAVE A NARROWER DIFFERENCE.
'AGAINST BRITISH DEFORMING PROJ, GAP IS NARROW TO 22.5 DEG & THEN WIDENS UNTIL REGULAR GAP USED ABOVE 45 DEG.
'PROJ THAT BREAK IF THEY DO NOT COMPLETELY PENETRATE HAVE 'VDFBRK' > 0 EXCEPT BRITISH-CPC-TYPE PROJ WHICH KEEP WWII-SIZE GAP
'BRITISH NON-CARDONALD DEFORMING ('VDFBND' > 0) PROJ MAY HAVE A NARROW OR WIDE NBL-TO-HBL DIFFERENCE (ESTIMATE HERE)

VDFUSEDPR = VDFUSED: SHATVDFPR = VDFUSED: 'DEFAULT VALUES

IF ((ARMR = 3) OR (ARMR = 4)) THEN
' HARVEYIZED STEEL ARMOR
  IF (TA >= 8) THEN
'FOR THINNER FACES (<= ~1.25/8 = 0.15625), PUNCHING THROUGH THE FACE DOES NOT
' FORM A PLUG THAT PUNCHES A HOLE THRU THE REST OF THE PLATE.  PLATE ACTS LIKE
' A HOMOGENEOUS PLATE IN THIS REGARD, WITH SMALL DIFFERENCE BETWEEN HBL & NBL.
' UNLIKE HOMOGENEOUS PLATE, THIS IS AT ALL OBLIQUITIES (NO LONG SLOT & SPUR
' AT HIGH OBLIQUITY).
    VDFTHIN = 0: 'NO CHANGE
  ELSE
'HARVEY BEGINS TO ACT LIKE KC ARMOR AS FACE PERCENT INCREASES IN THINNER PLATES
    VDFTHIN = -.023 * TA + .184
  END IF
  VHTRU = (1 - (VDFBRK + VDFTHIN)) * VLTRU
  VHND = (1 - (VDFBRK + VDFTHIN)) * VLND
'SHATR HBL IS RAISED (REDUCED PEN) FOR THESE PROJ, BUT NOT THE SHATR NBL
  VHSHAT = (1 - (VDFBRK + VDFTHIN)) * VLSHAT: VHSHAT = INT(VHSHAT): 'DITTO FOR SHATR HBL
  VHSHATMAX = (1 - (VDFBRK + VDFTHIN)) * VLSHATMAX: VHSHATMAX = INT(VHSHATMAX): 'DITTO FOR SHATR HBL
  VDFUSEDPR = VDFBRK + VDFTHIN
  IF ((VDFBRK + VDFTHIN) < SHATVDF) THEN SHATVDFPR = VDFBRK + VDFTHIN
ELSE
'ALL NON-HARVEY ARMOR
  IF ((VDFBND = 0) AND ((BRAIK = 0) OR (LTCASE = 2))) THEN
    VHTRU = (1 - VDFSTD) * VLTRU: 'DEFAULT AVERAGE NBL-TO-HBL DIFFERENCE FOR STRONGER, NON-DEFORMABLE PROJ OR 'LTCASE'=2 COLLAPSING PROJ BODY
    VHND = (1 - VDFSTD) * VLND
  ELSEIF (VDFBND > 0) THEN
    IF ((UB > 45) AND (UB < 70) AND (CART = 0) AND (SOFTSHAT = 1)) THEN
      VHTRU = (1 - (VDFSTD + VDFBND) / 2) * VLTRU: 'AVERAGE NBL-TO-HBL DIFFERENCE FOR DEFORMABLE PROJ & MEDIUM-THICKNESS FACE LAYERS
      VHND = (1 - (VDFSTD + VDFBND) / 2) * VLND
      VDFUSEDPR = (VDFSTD + VDFBND) / 2
    ELSE
      VHTRU = (1 - VDFBND) * VLTRU: 'AVERAGE NBL-TO-HBL DIFFERENCE FOR DEFORMABLE PROJ
      VHND = (1 - VDFBND) * VLND
      VDFUSEDPR = VDFBND
    END IF
  ELSE
'THIS IS THE AVERAGE NBL-TO-HBL DIFFERENCE FOR WEAK-BODIED PROJECTILES
' (EXCEPT BRITISH-CPC-TYPE) WHEN NO COMPLETE PEN OCCURS
    VHTRU = (1 - VDFBRK) * VLTRU
    VHND = (1 - VDFBRK) * VLND
'SHATR HBL IS RAISED (REDUCED PEN) FOR THESE PROJ, BUT NOT THE SHATR NBL
    VHSHAT = (1 - VDFBRK) * VLSHAT: VHSHAT = INT(VHSHAT): 'DITTO FOR SHATR HBL
    VHSHATMAX = (1 - VDFBRK) * VLSHATMAX: VHSHATMAX = INT(VHSHATMAX): 'DITTO FOR SHATR HBL
    VDFUSEDPR = VDFBRK
    IF (VDFBRK < SHATVDF) THEN SHATVDFPR = VDFBRK
  END IF
END IF

' FOR WEAK PROJECTILE, HBL ALWAYS USES SHATTER OB CURVE.  IF WEAK PROJECTILE BUT UNSHATTERED OB CURVE STILL USED FOR NBL (NO SWAP), 
'   THEN HBL USING UNSHATTERED PROJ OB CURVE NBL, AS CALCULATED ABOVE, IS WRONG.  MUST SWAP TO SHATTERED PROJ NBL CURVE, BUT WITHOUT
'   THE SHATTER THICKNESS MULTIPLIER APPLIED.  PROJ ALWAYS BREAKS BELOW NBL, SO SHATTER-CURVE DEFINES OB THICKNESS INCREASE FOR HBL.
IF (PLIM < .85) THEN
  VHTRU = VHTRU * (VLTRUWK/VLTRU): 'ALWAYS USE SHATTERED-PROJ-OB-CURVE NBL MOD 'VLTRUWK' FOR HBL VALUE
  IF (SWAPFLG = 1) THEN VLTRU = VLTRUWK: VLTRU = INT(VLTRU): 'ALSO USE IT FOR NBL, IF APPLICABLE (LESS-STRONG PLATES ALLOW USUAL NBL)
END IF
VHTRU = INT(VHTRU)
VHND = INT(VHND)

' ** END OF SUB MODIFYVDF **

END SUB

SUB NOSEBROKE STATIC

'UNSHATRD PROJ 'NSBRK > 0' SET LOGIC

'ALL FH PLATES USUALLY CAUSE NOSE DAMAGE (NOT SHATR HERE) IF VEL<NBL WHEN ANY OF THESE CONDITIONS APPLY:
' (1) PROJ BODY IS WEAK/BRITTLE (IMPLIES NOSE BRITTLE, TOO) & BREAKS IF IT DOES NOT
'     COMPLETELY PENETRATE PLATE ('BRAAK'>0)--INCLUDES ALL CHILLED CAST IRON PROJ ('SHATRES'=2)
' (2) PROJ HAS NO AP CAP ('HARD'=0) OR IT HAS ONLY A HOOD ('HARD'=-1) (CAN ACT AS LOW-GRADE SOFT AP CAP)
'     & HAS A WEAK BODY ('SHATRES' = 1) & IT HITS ARMOR OTHER THAN COMPOUND ARMOR ('CMPND'=0)
' (3) PLATE IS AN EXTRA-TOUGH (MOST POST-WWI) PLATE ('SOFTSHAT'=1)
'     & PROJ HAS A HOOD OR A SOFT AP CAP ('HARD'=-1 OR 1)
' (4) PLATE IS EXTRA-TOUGH BRITISH 1912-1930 ('SOFTSHAT'=2) & PROJ W/O HARD AP CAP
'     NOT MAX STRENGTH (NOT 'CARDONALD'=2)
' (5) OB>'NDAP' (FINAL CRIT NOSE DAM (OB-EX) THRESHOLD) & HITS WITH 'VS'<HBL ('PENFLG'=0)
' (6) HOLING PEN ('PENFLG'=1) & (OB-EX)>'NDAP' REGULAR LOGIC (ALSO USED FOR COMPLETE PEN)
' (7) PROJ 'VS'<HBL, NOT 'CARDONALD'=2 HOOD/SOFT-CAP MAX-STRENGTH TYPE,
'     & NEEDS EXTRA VEL TO HOLE ('VLMT'>'VLND')
' (8) OB>45 DEG NO MATTER WHAT

IF (NSBRK = 0) THEN
'IF SHATR 'NSBRK' = 2 ALREADY SET, IGNORE THIS LOGIC
  IF (BRAIK > 0) THEN
    IF (((ARMR = 3) OR (ARMR = 4)) AND (BEND = 2)) THEN
      NSBRK = 8: ' MIDVALE POST-1896 & PRE-UNBREAKABLE NOSE DEFORMED RATHER THAN BROKEN IF NO OTHER DAMAGE
    ELSE
      NSBRK = 1: ' WEAK-BODIED PROJ HAVE WEAK NOSES, TOO
    END IF
  END IF
' CHECK FOR OTHER NOSE DAMAGE THAT OVERRIDES DEFORMED NOSE RESULT
  IF (NSBRK <> 1) THEN
    IF ((HARD = -1) AND (SHATRES = 1) AND ((CMPND = 0) AND (ARMOR <> 3) AND (ARMOR <> 4))) THEN
      NSBRK = 4: ' HOODED COMMON PROJ NOSE BREAKAGE (ONLY WITH KC-TYPE ARMORS)
    ELSEIF ((ABS(HARD) = 1) AND (SOFTSHAT = 1)) THEN
      NSBRK = 5: ' ALL HOODED OR SOFT-CAPPED FULL AP PROJ NOSE BREAKAGE VS MAX-EXTRA-TOUGH PLATE
    ELSEIF ((ABS(HARD) = 1) AND (SOFTSHAT = 2) AND (CARDONALD < 2)) THEN
      NSBRK = 5: ' AVE HOODED OR SOFT-CAPPED FULL AP PROJ NOSE BREAKAGE VS BRIT 1912-30 EXTRA-TOUGH PLATE
    ELSEIF ((PENFLG = 0) AND (OB >= NDAP)) THEN
      NSBRK = 3: ' NO HOLE 'NDAP' CHECK
    ELSEIF ((PENFLG = 1) AND ((OB - EX) > NDAP)) THEN
      NSBRK = 3: ' HOLING 'NDAP' CHECK
    ELSEIF ((HARD > 1) AND (PENFLG = 0) AND (VLMT > VLND) AND (CARDONALD = 0)) THEN
      NSBRK = 6: ' IF HARD-CAPPED PROJ NEEDS HIGHER VEL TO MAKE HOLE, NOSE BREAKAGE IS PROBABLE CAUSE
    ELSEIF (OB > 45!) THEN
      NSBRK = 7
    END IF
  END IF
END IF

' ** END OF SUB NOSEBROKE **

END SUB

SUB NOSEDAM

'* NOSE DAMAGE CRITICAL OB MODIFICATION AND RESULTS CALC *

NDAP = NSDAMAGL: ''NSDAMAGL' VALUES ARE FOR AVERAGE WWI ARMOR, SO MODIFY THEM FOR OTHER KINDS OF ARMOR
IF (CMPND = 1) THEN
  NDAP = NDAP + 10: 'COMPOUND ARMOR IS WEAK
ELSEIF ((ARMR = 3) OR (ARMR = 4)) THEN
'HARVEY ARMOR FACE THICKNESS GETS VERY THIN
  IF (TA >= 8) THEN
'FACE LAYER CIRCA 12.5-18.75% (USING 1.25" FACE, SO USING 15.625%) AT 8"
'  & STEADILY DECREASES FROM THERE
    NDAP = NDAP + 10
  ELSE
'FACE LAYER UNDER 25% OF PLATE (AN OVER-5"-THICK PLATE), BUT OVER 15.625%
    IF (THNCHL = 1) THEN NDAP = NDAP + (5 + 5 * ((TA - 5) / 3))
  END IF
ELSEIF (THNCHL = 1) THEN
  NDAP = NDAP + 5: 'OTHER THIN CHILL ARMORS ARE ALSO WEAK, BUT NOT AS BAD
END IF
IF (SOFTSHAT = 1) THEN
  NDAP = NDAP - 10: ''SOFTSHAT' ARMOR IS MUCH BETTER THAN AVERAGE WWI ARMOR
ELSEIF (SOFTSHAT = 2) THEN
  NDAP = NDAP - 5: 'BRITISH WWI-ERA CA SHATTERS SOFT-CAPPED AP EXCEPT MIDVALE UNBREAKABLE
END IF
IF ((NDAP < 5) AND (NSDAMAGL > 0)) THEN NDAP = 5: 'USE A 5-DEGREE MIN ANGLE > 0
IF (NDAP < 0) THEN NDAP = 0: 'MIN ANGLE = 0

' ** END OF SUB NOSEDAM **

END SUB

SUB NSBDYDAMPRNT STATIC

' PRINT RESULTS OF PROJECTILE NOSE AND BODY DAMAGE COMPUTATIONS

BDYDM1$ = ""
BDYDM2$ = ""
BDYDM3$ = ""
BDYDM4$ = ""
BDYDM5$ = ""
NSBRK1$ = ""
NOPRNT = 0
'
SELECT CASE SHATPRT
  CASE 0
    IF ((SHAT = 1) AND (HARD = 2)) THEN
      PRINT "SPECIAL 155mm & 203mm JAP TYPE 91 AP PROJ W/CAP HEAD SHATTER LOGIC USED"
    ELSE
      PRINT "STANDARD SHATTER LOGIC USED"
    END IF
  CASE 1
    PRINT "PLATE TOO THIN TO SHATTER PROJECTILE AT THIS OBLIQUITY"
  CASE 2
    PRINT "HARVEY ARMOR WILL NOT SHATTER THIS PROJECTILE"
  CASE 3
    PRINT "COMPOUND ARMOR WILL NOT SHATTER THIS PROJECTILE"
END SELECT
'
SELECT CASE BDYDM
  CASE 0
    IF (PENFLG = 2) THEN
' COMPLETE PENETRATION
      IF (NSBRK = 8) THEN
        BDYDM1$ = "Projectile nose upset and deformed, but little lower body damage from impact."
        BDYDM2$ = " It is still 'effective' and intact, other than losing nose coverings."
      ELSEIF ((NSBRK > 0) AND (NSBRK < 8)) THEN
        BDYDM1$ = "Projectile nose " + ND$ + " by impact, but lower body undamaged."
        BDYDM2$ = " It is only 'effective' if this nose damage does not reach explosive cavity."
        IF (ND$ <> "deformed") THEN
          BDYDM3$ = " Nose loses" + BD1$ + "33% body weight and what's left is much weaker."
        END IF
      ELSE
        BDYDM1$ = "Neither projectile nose nor lower body damaged by impact."
        BDYDM2$ = " It is still 'effective' and intact other than losing nose coverings."
      END IF
    ELSE
' EITHER NO HOLE OR ONLY A HOLE MADE
      IF (NSBRK = 8) THEN
        BDYDM1$ = "Projectile nose upset & deformed; usually only insignificant lower body damage."
      ELSEIF ((NSBRK > 0) AND (NSBRK < 8)) THEN
        BDYDM1$ = "Projectile nose " + ND$ + " so 50% chance of major internal lower body damage."
        IF (ND$ <> "deformed") THEN
          BDYDM3$ = " Nose loses" + BD1$ + "33% body weight and what's left is much weaker."
        END IF
      ELSE
' NSBRK = 0
        BDYDM1$ = "Projectile nose intact so usually insignificant lower body damage occurs."
      END IF
      BDYDM2$ = " It is still 'effective' unless lower body damage is major internal damage or if"
      BDYDM4$ = "  nose damage reaches explosive cavity, then projectile will not be effective."
      BDYDM5$ = " 'Major internal'=base plug/fuze broken, deep cracks or base pieces snapped off."
    END IF
  CASE 1
    IF (NSBRK = 0) THEN
      BDYDM1$ = "Projectile nose undamaged, but lower body damaged by impact."
    ELSEIF (NSBRK = 8) THEN
      BDYDM1$ = "Projectile nose upset and deformed and lower body damaged by impact."
    ELSE
      BDYDM1$ = "Projectile nose " + ND$ + " and lower body damaged by impact."
      IF (ND$ <> "deformed") THEN
        BDYDM3$ = " Nose loses" + BD1$ + "33% body weight and what's left is much weaker."
      END IF
    END IF
    IF (((SHATRES > 0) AND (CMPND = 0)) OR ((SHATRES = 2) AND (CMPND = 1))) THEN
      BDYDM2$ = " It is not 'effective' and lower body is always broken apart by impact."
      BDYDM3$ = "": ' NOSE DAMAGE NOT IMPORTANT HERE
      NOPRNT = 1
    ELSE
      BDYDM2$ = " It is not 'effective' and lower body always suffers major internal damage."
      BDYDM5$ = " 'Major internal'=base plug/fuze broken, deep cracks or base pieces snapped off."
      NOPRNT = 1
    END IF
  CASE 2
    BDYDM1$ = "Projectile nose " + ND$ + " and lower body damaged by impact."
    BDYDM2$ = " It is not 'effective' and lower body is always broken apart by impact."
    NOPRNT = 1
END SELECT

'CHECK FOR NOSE DAMAGE

IF ((NSBRK = 0) OR (NSBRK = 8)) THEN
  NSBRK1$ = "If any, only projectile nose coverings stripped off. Nose still in one piece."
ELSEIF ((NSBRK < 8) AND (NOPRNT = 0)) THEN
  IF (LTCASE > 0) THEN
    NSBRK1$ = " Projectile's large explosive cavity is 'ineffective' due to major nose damage."
  ELSE
    NSBRK1$ = " Projectile's small explosive cavity rarely affected by any nose breakage."
  END IF
END IF

'****
'****>>PRINT IT TO SCREEN
'****

PRINT BDYDM1$
PRINT BDYDM2$
IF (BDYDM4$ <> "") THEN PRINT BDYDM4$
IF (BDYDM5$ <> "") THEN PRINT BDYDM5$

IF (NSBRK1$ <> "") THEN PRINT NSBRK1$
IF (BDYDM3$ <> "") THEN PRINT BDYDM3$

'  ** END SUB NSBDYDAMPRNT **

END SUB

SUB NUMVALHDR STATIC

PRINT "NUMERICAL VALUES:"
PRINT " 'UB'   = Percent Unhardened Back Layer (Scaling Factor step function logic)"
PRINT " 'Q'    = Relative Armor Resistance Quality (compared to best WWII armors)"
PRINT " 'QDAM' = Relative Armor Projectile Damaging Ability (ditto)"
PRINT "**Minimum value for 'Q' & 'QDAM' = 0.1.  Also, 'QDAM' can never exceed 'Q'.**"
PRINT "FLAGS:"
PRINT " 'CARTWL'   = If '1', brittle armor ejects huge plugs; if '2', at high OB only"
PRINT " 'CMPND'    = Compound Armor (never shatters steel projectiles)"
PRINT " 'THNCHL'   = Back layer over 75% of plate (reduced damage-causing ability)"
PRINT " 'SOFTSHAT' = Shatter soft-capped proj (='1'); except Midvale Unbreakable (='2')"
PRINT " 'THKTHN'   = Ductility lowers THIN boundary from .55 cal(0) to .45(2) or .35(1)"
PRINT "NOTE:  SEE PROGRAM LISTING OR DESCRIPTION DOCUMENT FOR DETAILS."

' ** END OF SUB NUMVALHDR **

END SUB

SUB PENPRINT (PNTP) STATIC

IF (SHAT = 1) THEN
  ND$ = "shattered"
ELSEIF (NSBRK = 8) THEN
  ND$ = "deformed"
ELSE
  ND$ = "broken"
END IF
REMVEL$ = "Proj Remaining Velocity: ": ONEPC$ = "": VTOTAL = 0
IF (SHAT = 1) THEN
  BD1$ = " at least "
  IF (BRK = 0) THEN BD1$ = " about ": 'NOSE-ONLY SHATR
ELSE
  BD1$ = " up to "
END IF
PEN1$ = "": PEN2$ = "": PEN3$ = "": BDYDM1$ = "": BDYDM2$ = "": BDYDM3$ = ""
NSBRK1$ = "": NSBRK2$ = "": NSBRK3$ = "": FLAKE$ = "": NOPLG$ = ""
WBL1$ = "": WBL2$ = "": WBL3$ = "": WBL4$ = "": TWOVEL$ = "": AMPER$ = ""
BSNS1$ = "": BSNS2$ = "": BSNS3$ = "": DPLG$ = "": RVU$ = ""

SELECT CASE PNTP
  CASE 0
    PEN1$ = "NO HOLING OF PLATE: Only impact shock & plate distortion damage behind plate"
    PEN2$ = " due to ductile plate &/or a plate backing layer (Projectile may be damaged)"
  CASE 1
    PEN1$ = "NO HOLING OF PLATE: Impact shock & plate distortion & thrown splinters cause"
    PEN2$ = " damage behind this brittle plate w/o any backing (Projectile may be damaged)"
  CASE 2
    PEN1$ = "PLATE HOLED AND NORMAL PLUG PUNCHED OUT, BUT INTACT PROJECTILE REJECTED"
    PEN2$ = " (No significant projectile damage suffered due to impact)"
    PEN3$ = " Proj might imbed in plate near NBL. If so, filler may cause damage thru plate."
  CASE 3
    PEN1$ = "PLATE HOLED AND NORMAL PLUG PUNCHED OUT, BUT DAMAGED PROJECTILE REJECTED"
    PEN2$ = " (If nose breaks up at OB<45 deg, part of nose (<= 33% body weight) penetrates)"
    PEN3$ = " Proj might imbed in plate near NBL. If so, filler may cause damage thru plate."
  CASE 4
    PEN1$ = "PARTIAL PENETRATION: Broken-up lower body (= 50% body weight) penetrates, but"
    PEN2$ = " projectile nose ricochets (Major damage behind plate if filler explodes/burns)"
  CASE 5
    PEN1$ = "PARTIAL PENETRATION: Broken-up nose & upper body (= 50% body weight) penetrate,"
    PEN2$ = " but projectile lower body rejected (Filler rarely has any effect behind plate)"
    PEN3$ = " Proj might imbed in plate near NBL. If so, filler may cause damage thru plate."
  CASE 6
    PEN1$ = "COMPLETE PENETRATION ACHIEVED: If Exit Angle > 0, Delta Plug pieces ejected"
    PEN2$ = " (If projectile is broken up, at least 80% of body weight exits plate back)"
END SELECT
PRINT PEN1$
PRINT PEN2$
IF (PEN3$ <> "") THEN PRINT PEN3$

' ** END OF SUB PENPRINT **

END SUB

SUB PENVRVPLGCALC STATIC

'DETERMINE 'PENTYP' & CALC REMAINING PLUG & PROJ VELOCITIES

'FOR PROJ LOWER/MIDDLE BODY PIECES AT HIGH OB BELOW NBL OR FOR ALL SHTRD BASE PIECES,
'   TOTAL PROJ WT ALWAYS USED IN NORMAL PLUG HOLE PUNCHING LOGIC.
'* VS >= NBL -- COMPLETE PEN *
''HF' = 1 MEANS NO UNSHTRD COMPLETE PEN (OB > 70 DEG)
IF ((HF = 1) OR (VS < VLMT)) THEN
'* VS < NBL -- HOLING ONLY *
  IF (OB < 45!) THEN
    IF ((SHAT = 0) OR ((SHAT = 1) AND (HARD = 2) AND (VS < VHSHAT) AND (VHOL < VHSHAT))) THEN
'UNSHATRD PROJ OR JAP UNCAPPED TYPE 91 AP W/CAP HEAD IN PLACE BELOW 'VHSHAT' (ACTS LIKE UNSHATRD PROJ)
      IF (BRK = 0) THEN
'PROJ REMAINS IN ONE PIECE OR HAS ONLY NOSE DAMAGE
        GOTO LTLPROJPEN
      ELSE
'* PROJ ASSUMED HERE TO BE BROKEN IN MIDDLE INTO AT LEAST 2 PIECES ON TOP OF ANY NOSE DAMAGE *
        PENTP = 5: VR = -1: VDPLUG = VRSHATNS: ''VRSHATNS' USED FOR ALL PARTIAL PEN
        GOTO ROUNDPLUG: 'EXIT
      END IF
    ELSE
'SHATRD PROJ
      IF (BRK = 0) THEN
        GOTO LTLPROJPEN: 'NOSE-ONLY SHATR
      ELSE
'* PROJ ASSUMED HERE TO BE BROKEN IN MIDDLE INTO AT LEAST 2 PIECES ON TOP OF ANY NOSE DAMAGE *
        PENTP = 5: VR = -1: VDPLUG = VRSHATNS: ''VRSHATNS' USED FOR ALL PARTIAL PEN
        GOTO ROUNDPLUG: 'EXIT
      END IF
    END IF
  ELSE
''OB'>=45 DEG
'* BASE/SIDE-FIRST HOLING W/NO DAMAGE, SHTR, OR LOWER/MIDDLE BODY DAMAGE *
'IF PROJ MIDDLE BODY BREAKS AT HIGH OB THEN ONLY LOWER BODY PIECES PEN,
'   BUT INCLUDES MOST OR ALL OF EXPLOSIVE FILLER.
    IF (BRK > 0) THEN
'* PROJ ASSUMED HERE TO BE BROKEN IN MIDDLE INTO AT LEAST 2 PIECES ON TOP OF ANY NOSE DAMAGE *
      PENTP = 4: VDPLUG = VRSHATNS: VR = -1
      GOTO ROUNDPLUG: 'EXIT
    ELSE
'* ONLY NOSE DAMAGE OCCURS SO NOTHING PENETRATES PLATE *
      GOTO LTLPROJPEN
    END IF
  END IF

LTLPROJPEN:
'NONE OR FEW PROJ PIECES GO THRU PLATE

  VR = -1: TOTPLUGWT = NORMPLUGWT: DELTAPLUGWT = 0
  IF (NSBRK > 0) THEN
    PENTP = 3: 'ONLY NOSE (33% OF PROJ BODY WEIGHT OR LESS) PENETRATES AT 'OB'<45 DEG
    IF (OB >= 45!) THEN
      VDPLUG = -1: 'NOTHING PENETRATES PLATE
    ELSE
      VDPLUG = 0: 'NOSE PIECES PENETRATE PLATE WITH VERY LOW REMAINING VEL
    END IF
  ELSE
    PENTP = 2: 'INTACT PROJ REJECTED/RICOCHETS
    VDPLUG = -1: 'NOTHING PENETRATES PLATE
  END IF
  GOTO ROUNDPLUG: 'EXIT

ELSE

'* COMPLETE PEN W/DELTA PLUG *
'DELTA PLUG, IF ANY, RIDES ON PROJ NOSE AT SAME VEL IN SAME DIRECTION.
'PROJ BASE VEL = 'VR' (SHTRD OR NOT) & SHTRD NOSE PIECES VEL IS 'VDPLUG'
''VDPLUG' = 'VR' ONLY IF NO SHATR
  PENTP = 6
  IF (SHAT = 1) THEN
'* SHATRD PROJ *
'BASE (OR NOSE PIECES AT OB >= 45 DEG):
'ONLY PEN IF 'VS' >= 'VLSHAT' & SUFFER EXTRA ENERGY LOSS
'THEY DO NOT AFFECT DELTA PLUG
    VR = VRPR
'NOSE PIECES (OR BASE PORTION ONLY AT OB >= 45 DEG THOUGH DELTAPLUGWT = 0 HERE):
    VDPLUG = VRSHATNS: IF (VDPLUG < VR) THEN VDPLUG = VR

  ELSE

'* UNSHATRD PROJ *
'PROJ REMAINING VEL = DELTA PLUG VEL (ONE VEL FOR ALL PROJ PIECES)
    IF ((OB < 45!) OR ((OB >= 45!) AND (BDYDM = 0))) THEN
      VR = VRPR: VDPLUG = VR
    ELSE
'NOSE PIECES AT OB >= 45 DEG W/BODY BREAKAGE:
      VR = VRPR
'BASE PIECES AT OB >= 45 DEG W/BODY BREAKAGE:
      VDPLUG = VRSHATNS: IF (VDPLUG < VR) THEN VDPLUG = VR
    END IF
  END IF
END IF

ROUNDPLUG:

VNPLUG = INT(VNPLUG): VDPLUG = INT(VDPLUG): VR = INT(VR): 'USE WHOLE NUMBERS IN COMPARES

' ** END OF SUB PENVRVPLGCALC **

END SUB

SUB PRNTARMR STATIC

' LIST ALL ARMOR TYPES TO CHOOSE FROM

PRINT "SELECT FACE-HARDENED ARMOR PLATE TYPE:"
PRINT "   1. Gruson Chilled Cast Iron (1868-90) (land fortification dome turrets)"
PRINT "   2. Average Compound (hardened-steel-faced wrought iron) (1880-90)"
PRINT "   3. Harveyized (cemented/carburized/case hardened) Mild Steel (1891-1900)"
PRINT "   4. Harveyized Nickel-Steel (1890(tests)-1900) (usual 'Harvey' armor)"
PRINT " SELECTIONS 5-8 ARE THE 4 FORMS OF THE ORIGINAL GERMAN 'KRUPP CEMENTED' ARMOR,"
PRINT "   KC 'a/A' ('OLD TYPE'), ON WHICH LATER FACE-HARDENED NAVAL ARMORS WERE BASED:"  
PRINT "   5. Original KC (1892-1894)(used Ni-only Steel < 9-inch) (Limited production)"
PRINT "   6. Original KC (1894-1905)(All of new Krupp Ni-Cr 'Quality 420' Alloy Steel)"
PRINT "   7. Improved KC for DREADNOUGHT-type ships (1906-1910) (OSTFRIESLAND Plates)"
PRINT "   8. Improved thin KC<8.11-inch; thicker unchanged (1911-1918) (BADEN Plates)"
PRINT "   9. German Post-WWI KC 'n/A' ('New Type') (1928-36) for 'Pocket BB' turrets"
PRINT "  10. German improved thick-plate KC n/A (1936-45) (SCHARNHORST & BISMARCK Cl.)"
PRINT "  11. Austro-Hungarian Witkowitz KC-type Armor--Best WWI KC (1898-1918)"
PRINT "  12. British average KC-type Armor manufactured 1912-21 (all manufacturers)"
PRINT "  13. British average KC-type Armor manufactured 1922-30 (all manufacturers)"
PRINT "  14. British average post-1930 Cemented Armor (CA)      (all manufacturers)"
PRINT "  15. Italian Terni Cemented Armor(TC)(thinner face for thick plates)(1935-45)"
PRINT "  16. Japanese Vickers Hardened Armor (VH) (non-cemented)(YAMATO Cl.)(1937-45)"
PRINT "  17. U.S. Midvale Non-Cemented Class 'A' (1907-12 & one cemented Lot in 1922)"
PRINT "  18. U.S. Bethlehem Thin Chill Class 'A' (1921-25) (also made by Midvale)"
PRINT "  19. U.S. average of all other (CKC, etc.) Class 'A' manufactured 1911-25"
PRINT "  20. U.S. average 1935-1943    Class 'A' (all manufacturers) (original)"
PRINT "  21. U.S. average 1944-1950    Class 'A' (all manufacturers) (improved)"
PRINT " SELECTION 22 BELOW INCLUDES ORIGINAL 1898 US CARNEGIE-KRUPP CEMENTED (CKC) AND"
PRINT "   BETHLEHEM NON-CEMENTED (BNC) (1906-1912) ARMOR TYPES. US MNC & BNC MADE W/O"
PRINT "   ANY LICENSE FROM KRUPP UNTIL ALL KRUPP KC PATENTS INVALIDATED BY US SUPREME"
PRINT "   COURT IN 1912, AFTER WHICH BETHLEHEM & MIDVALE REVERTED TO CEMENTED KC DUE"
PRINT "   TO BRITTLE CRACKING OF SOME BNC & MNC PLATES REQUIRING REPLACEMENT ON SHIPS."
PRINT "  22. Average of all other KC introduced before 1911 (including U.S. & Britain)"
PRINT "  23. Average of all other KC introduced between 1911 and 1921"
PRINT "  24. Average of all other KC introduced between 1922 and 1930"
PRINT "  25. Average of all other KC introduced after   1930 (French KC, etc.)"

IF (ARMR > 0) THEN PRINT "CURRENT ARMOR SELECTION ="; ARMR; "-- ";

' ** END OF SUB PRNTARMR **
END SUB

SUB REMVELPRNT STATIC
'PRINT REMAINING VELOCITY MESSAGES ON SCREEN

IF (VDPLUG < 0) THEN
  RVU$ = "Projectile Remaining Velocity NOT DEFINED"
  PRINT RVU$: ' NO PARTIAL OR COMPLETE PEN
ELSE

' CALC AVE PROJ REMAINING VEL FOR 1-PIECE DAMAGED PEN, IF USED & DIFFERENT FROM 'VDPLUG'
  IF (VDPLUG <> VR) THEN
    VTMP = (VDPLUG ^ 2 + VR ^ 2) / 2
    VTEMP = SQR(VTMP): VTOTAL = INT(VTEMP + .5): 'K.E. UNCHANGED
  END IF
  IF (DELTAPLUGWT > .05) THEN DPLG$ = "& Delta Plug ": ' ADD DELTA PLUG, IF THERE

  IF ((SHAT = 0) OR (PENTP = 3)) THEN
'UNSHATRD PROJ & UNCAPPED JAP TYPE 91 AP W/'VS'<'VHSHAT' BUT 'VS'>'VHOL' ('PENTP'=3)
    IF (OB < 45!) THEN
      IF (PENTP = 2) THEN
        BSNS3$ = "No Part of Projectile completely penetrates plate."
      END IF
      IF (PENTP = 3) THEN
        IF ((SHAT = 1) OR ((SHAT = 0) AND ((NSBRK > 0) AND (NSBRK < 8)))) THEN
          BSNS1$ = "Nose Pieces "
          BSNS3$ = "Projectile Body up to forward bourrelet fails to completely penetrate."
        ELSE
          BSNS3$ = "No Part of Projectile completely penetrates plate."
        END IF
      END IF
      IF (PENTP = 5) THEN
        IF ((NSBRK = 0) OR (NSBRK = 8)) THEN
          BSNS1$ = "Nose & Upper Body "
        ELSE
          BSNS1$ = "Nose Pieces & Upper Body"
        END IF
        IF (BDYDM < 2) THEN
          BSNS3$ = "Projectile Lower Body fails to completely penetrate."
          ONEPC$ = "If Projectile Body not broken up, No Part of Projectile completely penetrates."
        ELSE
          BSNS3$ = "Projectile Lower Body Pieces fail to completely penetrate."
        END IF
      END IF
      IF (PENTP = 6) THEN
        IF (BDYDM = 1) THEN
          IF (VDPLUG <> VR) THEN
            IF ((NSBRK = 0) OR (NSBRK = 8)) THEN
              BSNS1$ = "Nose & Upper Body "
            ELSE
              BSNS1$ = "Nose Pieces & Upper Body "
            END IF
            BSNS2$ = "Lower Body "
            ONEPC$ = "If Proj not broken, it ": 'ONLY IF PROJ DEFORMED, NOT BROKEN
          ELSE
            BSNS1$ = "Entire Projectile "
          END IF
        ELSEIF (BDYDM = 2) THEN
          IF (VDPLUG <> VR) THEN
            BSNS1$ = "Nose & Upper Body Pieces "
            BSNS2$ = "Lower Body Pieces "
          ELSE
            BSNS1$ = "All Projectile Pieces "
          END IF
        ELSE
'NO PROJ DAMAGE
          BSNS1$ = "Entire Projectile "
        END IF
      END IF
    ELSE
''OB'>=45 DEG
      IF (PENTP = 2) THEN
        BSNS3$ = "No Part of Projectile completely penetrates plate."
      END IF
      IF (PENTP = 3) THEN
' ONLY NOSE DAMAGE OCCURS (ABOVE FORWARD BOURRELET)
        BSNS3$ = "Entire Projectile ricochets off of plate."
      END IF
      IF (PENTP = 4) THEN
        IF ((NSBRK = 0) OR (NSBRK = 8)) THEN
          BSNS1$ = "Lower Body "
          BSNS3$ = "Projectile Nose & Upper Body ricochet off of plate."
        ELSE
          BSNS1$ = "Lower Body & Some Nose Pieces "
          BSNS3$ = "Most of Projectile Nose & Upper Body Pieces ricochet off of plate."
        END IF
        ONEPC$ = "If Projectile Body not broken up, All of Projectile ricochets off of plate."
      END IF
      IF (PENTP = 6) THEN
        IF (BDYDM = 1) THEN
          IF (VDPLUG <> VR) THEN
            IF ((NSBRK = 0) OR (NSBRK = 8)) THEN
              BSNS2$ = "Nose & Upper Body "
            ELSE
              BSNS2$ = "Nose Pieces & Upper Body "
            END IF
            BSNS1$ = "Lower Body "
          ELSE
            BSNS1$ = "Entire Projectile "
          END IF
          ONEPC$ = "If Proj not broken, it "
        ELSEIF (BDYDM = 2) THEN
          IF (VDPLUG <> VR) THEN
            BSNS1$ = "Lower Body Pieces "
            BSNS2$ = "Nose & Upper Body Pieces "
          ELSE
            BSNS1$ = "All Pieces "
          END IF
        ELSE
'NO PROJ DAMAGE
          BSNS1$ = "Entire Projectile "
        END IF
      END IF
    END IF
  ELSE
'SHATR ('SHAT'=1) EXCEPT 'VHSHAT'<='VS'<'VLSHAT' ('PENTP'=3)
'  INCLUDING JAP UNCAPPED TYPE 91 AP W/'VS'<'VHSHAT'
    IF (OB < 45!) THEN
      BSNS1$ = "All Nose Pieces "
      IF (VR >= 0) THEN
        IF (VDPLUG <> VR) THEN
          BSNS2$ = "Body Pieces "
        ELSE
          BSNS1$ = "All Pieces "
        END IF
      ELSE
        IF (VS >= VHSHAT) THEN
          BSNS3$ = "Projectile Body does not completely penetrate."
        END IF
      END IF
    ELSE
''OB'>=45 DEG
      BSNS1$ = "Body & Some Nose Pieces "
      IF (VR >= 0) THEN
        IF (VDPLUG <> VR) THEN
          BSNS2$ = "Most Nose Pieces "
        ELSE
          BSNS1$ = "All Pieces "
        END IF
      ELSE
        BSNS3$ = "Most Projectile Nose Pieces do not completely penetrate."
      END IF
    END IF
  END IF

  IF (BSNS1$ <> "") THEN
    PRINT REMVEL$; BSNS1$; DPLG$;
    IF (VDPLUG >= 25) THEN
      PRINT "="; VDPLUG; "ft/sec"
    ELSE
      PRINT "ARE VERY SLOW"
    END IF
  END IF
  IF (BSNS2$ <> "") THEN
    PRINT REMVEL$; BSNS2$;
    IF (VR >= 25) THEN
      PRINT "="; VR; "ft/sec"
    ELSE
      PRINT "ARE VERY SLOW"
    END IF
  END IF
  IF (ONEPC$ <> "") THEN
    IF (PENFLG = 2) THEN
      PRINT ONEPC$; DPLG$;
      IF (DPLG$ = "") THEN PRINT "has"; :  ELSE PRINT "have";
      IF (VTOTAL >= 25) THEN
        PRINT " Remaining Velocity ="; VTOTAL; "ft/sec"
      ELSE
        PRINT " VERY SLOW Remaining Velocity"
      END IF
      IF (BSNS3$ <> "") THEN PRINT BSNS3$
    ELSE
      IF (BSNS3$ <> "") THEN PRINT BSNS3$
      PRINT ONEPC$
    END IF
  ELSE
    IF (BSNS3$ <> "") THEN PRINT BSNS3$
  END IF
END IF

'** END OF SUB REMVELPRNT **

END SUB

SUB SHATRDAM STATIC
'SHATRD PROJ DAMAGE LOGIC. SEPARATE NOSE-ONLY SHATR FROM REGULAR COMPLETE-BODY SHATR
'
IF (((CRVRL = 1) AND (BRAIK = 0)) OR ((PENFLG = 2) AND (NSSHAT > 0) AND (NSSHAT <> 2)) OR (NSSHAT = 2)) THEN
  NSBRK = 2: BRK = 0: BDYDM = 0: 'ONLY NOSE BREAKAGE IF CURVED-PLATE RULE OR SOFTSHAT PLATE RULE OR UNDER MIN NOSE SHTR VEL FOR STRONGER PROJ
ELSEIF ((PENFLG < 2) AND (NSSHAT > 0)) THEN
  NSBRK = 2: BRK = 2: BDYDM = 2: 'NOSE SHATR WEAKENS PROJ SO THAT IT BREAKS UP IF VEL < NBL
ELSE
  NSBRK = 2: BRK = 1: BDYDM = 2: 'REGULAR COMPLETE BODY SHATR OCCURS
END IF

' ** END OF SUB SHATRDAM **
END SUB

SUB SHTRMULTSELECT STATIC

' SHATTER INCREASES HBL, WHICH ALSO INCREASES NBL.
' SELECT WHICH HBL SHATTER MULTIPLIER TO USE

IF ((ARMR = 3) OR (ARMR = 4)) THEN
  IF (TA >= 8) THEN
    SHATMULT = 1!:  'NORMAL IMPACT BONUS FOR THICK HARVEYIZED ARMORS = NO EFFECT, SINCE SHELL DAMAGE HAPPENS DUE TO ITS BRITTLENESS, ANYWAY
  ELSE
    SHATMULT = 1.25 - .03125 * TA: 'HARVEYIZED ARMOR HAS FIXED FACE LAYER GET LINEARLY THICKER AS PLATE THINS (WHEN <8" GETS MORE & MORE KC-LIKE)
  END IF
' SHATR FOR HARVEY ARMOR TURNS UNSHTRED NBL INTO **FACE-LAYER** HBL USING KC
'  'VDFSTDWWI' HBL-TO-NBL VEL DIFF, *BUT* THIN FACE CANNOT PUNCH OUT BACK
'  LAYER (HOLE COMPLETELY THRU PLATE) UNTIL HBL USING SMALLER 'VDFBRK' REACHED,
'  BUT BELOW 8" PLATE THICKNESS VEL DIFF BEGINS TO WIDEN DUE TO THICKER FACE.
'  ALSO, VERY BRITTLE OLD PROJECTILES ALREADY BREAK UP MUCH LIKE SHATTER ON FAILURE TO PENETRATE.
ELSEIF ((SOFTSHAT = 2) AND (ABS(HARD) = 1) AND (NSSHAT = 1) AND (OB <= 20!)) THEN
  SHATMULT = 1.2: 'NORMAL OB BONUS FOR IMPROVED BRITISH WWI PLATES & REGULAR SOFT-CAPPED PROJ AT OB<=20 DEG
ELSEIF ((SOFTSHAT = 1) AND (HARD < 3) AND (BEND = 0) AND ((NSSHAT = 0) OR (NSSHAT = 2) OR (OB > 20!))) THEN
  SHATMULT = 1.4: 'NORMAL OB BONUS FOR BEST SOFTSHAT PLATES WHEN PROJ EITHER HAS COMPLETE SHATR OR HAS NOSE-ONLY SHTR DUE TO TOO-LOW VELOCITY AT OB<=15 DEG
ELSE
  SHATMULT = 1.3: 'NORMAL OB BONUS FOR EVERY OTHER CASE

'WORST CASE FOR REGULAR SHATTER CALCULATION IS PLIM = .85 & SHATMULT = 1.4, WHERE PENETRATION DROPS TO ONLY 60.7% OF BEST NON-SHATTER CASE
IF ((PLIM / SHATMULT) < .607) THEN SHATMULT = PLIM  / .607: 'THIS IS ALSO WORST CASE FOR **ANY** OTHER SHATTER PENALTY 
IF (SHATMULT < 1!) THEN SHATMULT = 1!: 'SHATTER CANNOT IMPROVE PENETRATION AT NORMAL, BUT IT MIGHT NOT CHANGE ANYTHING FOR POOREST PROJ

END IF

' ** END OF SUBROUTINE SHTRMULTSELECT **

END SUB

SUB SPLNTRPRNT STATIC

' PRINT INFORMATION ON SPLINTERS THROWN FROM PLATE BACK ON HITS BELOW THE HBL
FLAKE$ = ""
IF (NORMPLUGWT <= .05) THEN
  IF (BKEFF = 0) THEN
    IF (CART > 0) THEN
      FLAKE$ = "Many dangerous splinters thrown from plate back likely due to impact shock."
    ELSE
      FLAKE$ = "Few dangerous splinters thrown from plate back due to impact shock."
    END IF
  ELSE
    FLAKE$ = "Backing material stops splinters thrown from plate back due to impact shock."
  END IF
END IF
IF (FLAKE$ <> "") THEN PRINT FLAKE$

'  ** END OF SUBROUTINE SPLNTERPRNT **

END SUB

SUB THINPRINT STATIC

'CALCULATE 'TRUTHIN' & PRINT OUT THIN EFFECTS INFO

IF (THIN = .35) THEN
  TRUTHIN = .25
ELSEIF (THIN = .45) THEN
  TRUTHIN = .35
ELSE
  TRUTHIN = .45
END IF
THNTP = 100 * TRUTHIN * D + .5: THINPRT = INT(THNTP) / 100
THKTP = 100 * THIN * D + .5: THKPRT = INT(THKTP) / 100
PRINT
IF (TRUTHIN = .25) THEN
  PRINT "THIS ARMOR IS THE MOST DUCTILE ('THKTHN' = 1) TYPE FACE-HARDENED PLATE."
ELSEIF (TRUTHIN = .35) THEN
  PRINT "THIS ARMOR IS A MORE DUCTILE ('THKTHN' = 2) TYPE FACE-HARDENED PLATE."
ELSE
  PRINT "THIS ARMOR IS AN OLDER, BRITTLE ('THKTHN' = 0) TYPE FACE-HARDENED PLATE."
END IF
PRINT "IT IS 'THIN' BELOW"; TRUTHIN; "CALIBER =";
ES$ = "": IF (THINPRT > 1!) THEN ES$ = "ES"
PRINT THINPRT; "INCH"; ES$; " FOR D ="; D; "INCH";
IF (TRUTHIN <> THIN) THEN
  IF (D > 1!) THEN PRINT "ES":  ELSE PRINT
  PRINT "  AND IT IS 'THICK' ABOVE"; THIN; "CALIBER =";
  ES$ = "": IF (THKPRT > 1!) THEN ES$ = "ES"
  PRINT THKPRT; "INCH"; ES$; "."
  PRINT "BETWEEN THESE 2 EXTREME VALUES, PROGRAM STEPS DOWN PLATE RESISTANCE TWICE."
ELSE
  IF (D > 1!) THEN PRINT "ES.":  ELSE PRINT "."
  PRINT "WITH THIS ARMOR, THE CHANGE FROM 'THICK' TO 'THIN' IS ABRUPT."
END IF

' ** END OF SUB THINPRINT **

END SUB

SUB THINSELECT STATIC

'U.S. WWI-ERA TESTS SHOW BRITTLE FH ARMORS LOST STRENGTH IF <0.55-CAL EFFECTIVE THICKNESS,
'  REDUCING 'MSHAT' FOR SUCH 'THIN' ARMOR. LATER, TOUGHER PLATES ('THKTHN' FLAG = 1 OR 2)
'  ACT AS 'THIN' PLATES IF <0.35-CAL ('THKTHN= 1'), BASED ON FRENCH 15CM KC-TYPE TURRET ROOF
'  PLATE OF *DUNKERQUE* HIT BY BRITISH 15" MK 13A APC PROJ IN 1940. VALUES FOR 'THKTHN = 2'
'  ARE ON BRITISH 15" MK 5A 'GREENBOY' PROJ HITS ON 7" WWI BRITISH KC. MODIFICATION BASED ON
'  BRITISH 15" MK 17B APC PROJ HITS ON 4.9" CA PLATES AT 60 DEG., 'THKTHN=1' ARMOR HAS TRUE
'  THIN FOR <0.25-CAL EFFECTIVE THICKNESS & 'THKTHN=2' ARMOR HAS TRUE THIN FOR <0.35-CAL
'  EFFECTIVE THICKNESS.  BOTH NON-ZERO 'THKTHN' ARMORS USE A 4-STEP DROP FROM THE THICK VALUE
'  TO THE TRUE THIN VALUE WITH THE INTERMEDIATE STEPS BISECTING THE RANGE BETWEEN THICK & THIN.
'  THE 0.3-0.35 THICKNESS PART FOR 'THKTHN=1' & THE 0.4-0.45 PART FOR 'THKTHN=2', USE 0.625
'  OF THE DIFFERENCE IN RESULTS, & 0.3 OF THE DIFFERENCE IN REMAINING RANGE (FROM BRIT TESTS).
IF (THKTHN = 1) THEN
  THIN = .35
ELSEIF (THKTHN = 2) THEN
  THIN = .45
ELSE
  THIN = .55
END IF

' ** END OF SUB THINSELECT **
END SUB

SUB THRESHOLDCALC STATIC
'* COMPUTE MINIMUM EFFECTIVE-FILLER OR NO-NOSE-DAMAGE VELOCITY THRESHOLD VALUE *

'ALWAYS USE DAMAGE/NO-DAMAGE BOUNDARY FOR 'EBL' & USE ACTUAL 'VLEX/VHEX' VALUES FOR NOSE DAMAGE CALC

''THVAL' IS PROJ CRITICAL DEFLECTION ANGLE CALCULATED PREVIOUSLY (NOSE OR BODY, AS SELECTED)
''THVAL' = DEFLECTION = 'OB' - 'EX' WHEN STRIKING VEL IS AT MIN FOR DAMAGE
'WE MUST FIND THE STRIKING VEL THAT GIVES AN 'EX' FOR GIVEN 'OB' SUCH THAT 'THVAL' IS EXACTLY REACHED
'SHATRD PROJ NEVER USES THIS LOGIC ('VHEXREV' = 'THSPD' FOR NOSE-ONLY SHATTR ONLY) (HOWEVER, SHATR IS INCLUDED IN LOGIC)
THSPD = 0: 'INITIALIZE FINAL CRITICAL THRESHOLD VELOCITY 'THSPD'
IF (THVAL <= OB) THEN
'PROJECTILE DAMAGE POSSIBLE, SO DO CALCULATION OF THRESHOLD VELOCITY
  EXTH = OB - THVAL: ''EXTH' = VALUE OF 'EX' WHEN VEL = CRITICAL VEL (MIN 'EX' = 15 IF 'OB' >= 15 & NO SHAT)
  IF ((SHAT = 1) OR ((EXTH > 15!) AND (OB > 15!))) THEN
'IF 'EXTH' > 15, THEN MINIMUM UNDAMAGED PROJ VEL IS ABOVE 'VLEXREV'

'USE ALL OF 'THVAL' FOR COMPUTATION
'COMPUTE 'THSPD' USING INVERSE OF 'EX' VEL RATIO FORMULA IF > 'VLEXREV'
'SNCSMAX' IS DEFLECTION-AT-'VLEXREV' ('MAXDF') FUNCTION FOR (OB - EXMIN) <= 45 DEG (SEE 'EX' CALC LOGIC)
'DIVIDE BY '(1 + OB45)' FIX IS FOR (OB - EXMIN) > 45 DEG (CHANGE IN 'OB45' SAME AS CHANGE AT 45 DEG)
    TEMP0 = THVAL / 57.29578
    TEMP1 = TEMP0 / (1 + OB45)
    TEMP2 = SIN(TEMP1) * COS(TEMP1): 'CRITICAL BODY OR NOSE DEFLECTION FUNCTION (AS SELECTED)
    TEMP3 = SNCSMAX / TEMP2
    TEMP4 = 2 * TEMP3 - 1
    IF (TEMP4 < 0) THEN TEMP4 = 0
    THSPD = VLEXREV * TEMP3 / SQR(TEMP4)
    IF (THSPD < VLEXREV) THEN THSPD = VLEXREV: 'VEL THAT CAUSES DEFLECTION ANGLE 'THVAL'
  ELSE
'LOGIC FOR THRESHOLD VEL 'THSPD' IF IT IS AT OR UNDER 'VLEXREV' ('EXTH' <= 15)
'   OR IF 'OB' <= 15:  BOTH USE A LINEAR INCREASE IN 'EX' WITH VEL BETWEEN 'VHOL' & 'VLMT'
    IF (OB <= 15!) THEN
      THVUSD = THVAL: 'ALL OF 'THVAL' USED IN LINEAR CALC ('MAXDIFF' = 'OB' & MIN 'EX' = 0)
    ELSE
'FIND VEL BY SUBTRACTING RATIO OF DIFF BETWEEN 'EX' AT 'VLEXREV' ( = 'MAXDIFF' = 15) & 'EX' AT MIN CRITICAL VEL
      THVUSD = 15! - EXTH: 'USE ONLY PORTION OF 'THVAL' IN THE UNDER 15 REGION FOR CRITICAL VEL CALC
    END IF
    THSPD = VLEXREV - (THVUSD / MAXDIFF) * (VLEXREV - VHEXREV): 'LINEAR INCREASE IN 'EX' WITH VEL FROM HBL TO NBL
  END IF
'ROUND 'THSPD' TO EXACTLY EQUAL 'VLMT' OR 'VHOL' IF SO ROUNDED ON DISPLAY
  THCHK = ABS(THSPD - VLMT): IF (THCHK < .5) THEN THSPD = VLMT
  THCHK = ABS(THSPD - VHOL): IF (THCHK < .5) THEN THSPD = VHOL
END IF

'  ** END OF SUB THRESHOLDCALC **

END SUB

SUB USPROJ STATIC

' SCREEN PRINT OF AMERICAN PROJECTILE OPTIONS

PRINT " 1. Ave. Army/Navy (A/N) Chilled Cast Iron Shot & All Common Shell(1860-1910)(*)"
PRINT " 2. Ave. capped Chilled Cast Iron Army Coast Defense(ACD)Shot/Shel(1898-1910)(*)"
PRINT " 3. A/N Steel AP Shot/Shell          (0-6% black-powder/Ex.D filler) (1890-1910)"
PRINT " 4. A/N soft-capped Steel APC Shot/Shell(0-6% blk-pwdr/Ex.D flr)(1897-1910N/20A)"
PRINT " 5. Midvale tough-steel AP Shot/Shell (0-6% black-powder/Ex.D filler)(1895-1910)"
PRINT " 6. Midvale tough soft-capped APC Shot/Shell(0-6% blk-pwdr/Ex.D filr)(1897-1910)"
PRINT " 7. Base-fuzed 7/12/14-in 'Bombardment' (Light-case)(9-11% Ex.D filler)(1914-42)"
PRINT " 8. Ave. Navy 1911-23 APC except Navy Midvale 8-in Mk 11 (1911) & 'Midvale 1916'"
PRINT " 9. Navy Midvale 8-in Mk 11 (1911) & all Navy 'Midvale Unbreakable 1916' APC"
PRINT "10. Average 1921-1935 ACD APC Shot    (2-3% Ex. D filler)  ('Midvale Army 1921')"
PRINT "11. Average post-1935 ACD APC Shot (1.4-2% Ex. D filler)(= Ave. Navy APC c.1940)"
PRINT "12. Ave WWI-era base-fuzed Common(some w/windscreens)(4-5% Ex.D filler)(1910-30)"
PRINT "13. Ave Special Common(w/Hood/windscreen/base fuze)(3-4.4% Ex.D filler)(1930-45)"
PRINT "      ** EXCEPT 6-in Mark 27 and 8-in Mark 15 Special Common **"
PRINT "14. 6-in Mk 27-1-6 Special Common (= US Army AP) (2.1-2.4% Ex.D filler)(1933-45)"
PRINT "15. 8-in Mk 15-1 hard-capped Special Common (= SAPC)   (4.4% Ex.D filler) (1930)"
PRINT "16. 3-in Mk 29-1/30-1 (to 1944) and 8-in Mk 19-1-3 (to 1941) & ACD Mk 20-1 APC"
PRINT "17. 8-in Mk 19-4-6 APC"
PRINT "18. 6-in Mk 35-1-8 and 16-in Mk 8-1-5 (to 1944) APC"
PRINT "19. 8-in Mk 21-1-4, 14-in Mk 16-1-6 (to 1943) & ACD Mk 20-1, and"
PRINT "      16-in Mk 5-1-4 (to 1944) & Mk 5-6 (ex-ACD Mk 12-1 w/Mk 21 BDF) APC"
PRINT "20. 3-in Mk 29-2/30-2, 6-in Mk 35-9-11, 8-in Mk 21-5, 12-in Mk 18-1,"
PRINT "      14-in Mk 16-7-11, and 16-in Mk 5-5 & Mk 8-6-8 APC"
PRINT
PRINT " * = ESTIMATED FROM LIMITED DATA"

' ** END OF SUB USPROJ **
END SUB

SUB VERSIONPRNT (VCOUNT)

' PRINT DEFINITIONS AND NEW VERSION 6.8 TO 7.7 INFORMATION HERE)

SELECT CASE VCOUNT
  CASE 1
    PRINT "IMPORTANT DEFINITIONS:"
    PRINT "NBL = MINIMUM STRIKING VELOCITY TO ALLOW PROJECTILE TO COMPLETELY PASS THROUGH": '1
    PRINT "      PLATE WITH THE MINIMUM POSSIBLE REMAINING VELOCITY.  IF PROJECTILE BREAKS": '2
    PRINT "      THEN 80% OF THE BODY MAKES IT THROUGH.  ALWAYS IGNORE AP CAP, HOOD, OR": '3
    PRINT "      WINDSCREEN, IF ANY, IN THIS DETERMINATION. (NAVY BALLISTIC LIMIT)": '4
    PRINT "HBL = MINIMUM STRIKING VELOCITY TO MAKE A HOLE IN THE PLATE OF ROUGHLY CALIBER": '5
    PRINT "      SIZE OR GREATER, PUNCHING OUT A PLUG OF ARMOR THROUGH PLATE BACK, INTACT": '6
    PRINT "      OR BROKEN UP.  MAY BE JUST BELOW OR FAR BELOW NBL, DEPENDING ON PLATE": '7
    PRINT "      TYPE, PROJECTILE TYPE, PROJECTILE CONDITION AFTER IMPACT, & OBLIQUITY.": '8
    PRINT "      A LITTLE ABOVE 'THROUGH-CRACK' BALLISTIC LIMIT. (HOLING BALLISTIC LIMIT)": '9
    PRINT "EBL = MINIMUM STRIKING VELOCITY, WHEN IT EXISTS, TO ALLOW PROJECTILE FILLER TO": '10
    PRINT "      EXPLODE PROPERLY (FUZE & BASE PLUG OK AND NO CAVITY CRACKS). NOSE DAMAGE": '11
    PRINT "      WILL ONLY COMPROMISE THIS IF PROJECTILE HAS A VERY LARGE CAVITY (OVER 6%": '12
    PRINT "      FILLER CAN FIT INTO CAVITY, EVEN IF LESS WAS USED) OR USES A NOSE FUZE.": '13
    PRINT "      USUALLY, I ASSUME PROJECTILE BODY COMPLETELY INTACT, THOUGH NOSE-ONLY": '14
    PRINT "      SHATTER, AMONG OTHER THINGS, MAY MODIFY THIS. (EFFECTIVE BALLISTIC LIMIT)": '15
    PRINT "OB  = ANGLE OF PROJECTILE CENTERLINE COMPARED TO NORMAL (RIGHT ANGLES) LINE AT": '16
    PRINT "      CENTER OF IMPACT SITE (YAW ASSUMED ZERO OR ALREADY INCLUDED). MAXIMUM OB": '17
    PRINT "      USED (DEG): NO SHATTER-->70; IF SHATTER-->75 W/THICK PLATE, 80 OTHERWISE": '18
    PRINT "EX  = ANGLE PROJECTILE REMAINING VELOCITY VECTOR MAKES WITH NORMAL LINE ABOVE": '19
    PRINT "      WHEN PROJECTILE EXITS PLATE BACK (ALSO COMPUTED FOR PLUG VELOCITY CALCS": '20
    PRINT "      EVEN IF PROJECTILE FAILS TO COMPLETELY PENETRATE, BUT IS ABOVE HBL).": '21
'
    PRINT "CONTINUE? (Y=Yes/N=Skip Rest (Any other entry does nothing)) ";
'
  CASE 2
'
    PRINT "VERSION 7.0 CHANGES:"
    PRINT "(1)  Added a small modification to Scaling Factor for all Harveyized plates."
    PRINT "       The effects at all face layer thicknesses are slightly greater than KC"
    PRINT "       due to, I believe, the more brittle armor material and the harder,"
    PRINT "       cementite-only face, especially in thin plates vs. small projectiles."
    PRINT "(2)  Added some more comments concerning effects on the HBL from deforming"
    PRINT "       British post-WWI APC designs.  Note that there are few data points for"
    PRINT "       obliquities above 40 degrees, so my 45-degree 'lid' is an estimate."
    PRINT "(3)  Found more information on the Japanese experimental 18cm (7.25-inch) &"
    PRINT "       38cm (14.96-inch) VH plates tested by the US & Britain after WWII that"
    PRINT "       gave extraordinary results (best plates ever tested by either nation!)."
    PRINT "       If you use German KC n/A armor specs & increase plate quality by 1% for"
    PRINT "       the 18cm plate and 1.5% for the 38cm plate, the results match exactly."
    PRINT "       These seem to be hybrid Japanese/German plates made by the Japanese"
    PRINT "       developers, though never applied to any ship armor since no more of"
    PRINT "       the YAMATO Class were built.  High quality control really works!!!"
    PRINT "THIS IS THE ONLY VERSION 7.1 CHANGE:"
    PRINT "French Projectile Selection #9 (US-made 38cm APC shell) was broken.  Fixed."
'
    PRINT "CONTINUE? (Y=Yes/N=Skip Rest (Any other entry does nothing)) ";
'
  CASE 3

    PRINT "VERSION 7.2 CHANGES:"
    PRINT "A considerable amount of data on many German pre-WWI shells & armor varients" 
    PRINT "sent to me by a researcher of German archives.  The changes made to FACEHARD"
    PRINT "are as follows (plus some minor comment and variable adjustments):"
    PRINT "(1) The original Krupp KC a/A was made in 1892 with 7% Ni-steel (no Cr) for a"
    PRINT "couple of German ships in plates up to (nominal) 225mm (8.86-inch).  It was"
    PRINT "not possible to make thicker plates of acceptable quality.  In 1894, a new"
    PRINT "Ni-Cr steel -- of now-classic 'Krupp Steel' alloy -- was used in a ductile"
    PRINT "homogeneous Krupp plate #420 and found to be superior to Ni-only steel armor."
    PRINT "This 'Quality 420' steel formed the basis for all further Krupp-type armor"
    PRINT "steels used by everybody for all Army and Navy armors.  However, the KC type"
    PRINT "made from it was significantly more brittle and weaker than later KC armors."
    PRINT "(2) In 1906, in time for all German DREADNOUGHT-type warships, an improved"
    PRINT "form of KC a/A using better alloy control and heat treatment was developed"
    PRINT "that was much superior and could now match improved KC armor made by foreign"
    PRINT "manufacturers -- Krupp tended to be slow to change things if successful."
    PRINT "The OSTFRIESLAND KC armor tested after WWI by the U.S. Navy was of this kind"
    PRINT "and all plates of various thicknesses were found to be the same quality."
    PRINT "(3) The BADEN KC plates tested by the British Navy after WWI had the thicker"
    PRINT "plates match the OSTFRIESLAND quality, but all plates under (nominal) 200mm"
    PRINT "(7.87-inch) were considerably better, in agreement with Krupp 15cm APC tests."
    PRINT "(4) Krupp's AP (Pgr.) projectiles had no AP caps until 1902, when they put on"
    PRINT "soft AP caps to create the first APC (Pgr.m.K. L/2,6) projectiles.  While"
    PRINT "they had previously added soft caps to base-fuzed Common-type (Spgr.) test"
    PRINT "shells for use against thinner face-hardened in smaller ships, AP quality"
    PRINT "at the time was considered too poor to allow intact shells through thick KC"
    PRINT "armor in most impacts, so why bother with a filler which would rarely work"
    PRINT "after penetration, anyway?  These Krupp AP shot projectiles had rather poor"
    PRINT "penetration ability, capped or not, compared to later, post-1906 AP & APC."
    PRINT "(5) In fact, many pre-1906 AP and Common projectiles in general use by all"
    PRINT "nations were inferior to my previous quality value estimates and have been"
    PRINT "reduced in FACEHARD 7.2. Krupp's pre-1906 KC test results were used here."
    PRINT "(6) Reducing the 1890s projectile quality values required me to re-calibrate"
    PRINT "all pre-KC armor quality downward by similar amounts to keep the results of"
    PRINT "their ballistic tests matching velocity values found. All lost some quality."
    PRINT "Note the reduction is from face-layer damage; not against homogeneous armor."  
    PRINT "(6) The advent of improved steel quality due to improved metallurgy in 1906"
    PRINT "allowed Krupp to make improved, TNT-filled APC (Psgr.m.K. L/2,9) projectiles,"
    PRINT "initially with an experimental 15cm (5.91-inch) APC projectile that at normal"
    PRINT "was almost invulnerable to damage by pre-1906 KC a/A armor."

    PRINT "CONTINUE? (Y=Yes/N=Skip Rest (Any other entry does nothing)) ";

  CASE 4

'THIS IS THE LAST CHANGE INFO PAGE

    PRINT "VERSION 7.2 CHANGES (CONTINUED):"
    PRINT "(7) However, a larger 17cm (6.69-inch) Psgr.m.K. L/3 projectile developed in"
    PRINT "1904 for the last pre-Dreadnoughts turned out to be much inferior to these"
    PRINT "new 15cm L/2,9 in quality, with no better penetration than the previous L/2,6"
    PRINT "APC shot against KC plates.  This failure was not repeated in any later APC"
    PRINT "shells made by Krupp, to my knowledge."
    PRINT "(8) The BADEN's 38cm (14.96-inch) Psgr.m.K. L/3,5 & tested 35cm (13.78-inch)"
    PRINT "Psgr.m.K. L/3,6 shells were of improved design with thicker caps similar to" 
    PRINT "Skoda shells and long windscreens, I assume to reduce oblique impact damage."   
    PRINT "(9) If a projectile is so weak that it suffers so much damage on failure to"
    PRINT "penetrate that results similar to shattered high quality projectiles occur,"
    PRINT "it will also always use the shattered projectile obliquity effects curves,"
    PRINT "for either holing only or both holing and complete penetration, depending on"
    PRINT "the armor quality, with or without shatter.  Added logic to do this."
    PRINT "(10) Removed hard copy option.  Did not work with current WINDOWS versions."
    PRINT "THIS IS THE ONLY VERSION 7.3 CHANGE:"
    PRINT "In new logic switching to the SHATTERED PROJECTILE OBLIQUITY CURVE from the"
    PRINT "UNSHATTERED PROJECTILE OBLIQUITY CURVE for weak projectiles (Qproj < 0.85),"
    PRINT "I did not change from thickness ratio to velocity ratio when modifying the HL"
    PRINT "and NBL, where applicable.  Had to change 'M(OB shatter)/M(OB no shatter)' or"
    PRINT "its inverse, when used, by raising this ratio to the 1/1.21 power (variable"
    PRINT "'VXP' in FACEHARD), since velocities to the 1.21 power change the thickness"
    PRINT "penetrated and both of the M(OB) tables are multiplying plate thicknesses,
    PRINT "not the HL or NBL, so the 1.21 power is reversed to change velocities. Fixed."   
    PRINT "VERSION 7.4 CHANGES:"
    PRINT "(1)  Corrected chilled cast iron proj notes: They were made from c.1860."
    PRINT "(2)  Fixed some typoes and incorrect notes in projectile & armor selection"
    PRINT "tables to match latest program logic and newly discovered information."
    PRINT "(3)  Added soft-capped 'Stgr.' ('Steel Shell') as separate entry; not used in"
    PRINT "German Navy warships, but used to test experimental KC plates in late-1890s."
    PRINT "(4)  Added Ni-only 1st form of KC armor (1892-94) as separate entry due to"
    PRINT "finally getting a test of a 146mm plate of that type versus uncapped Krupp AP"
    PRINT "steel shot, where Holing Limit was roughly determined by shattered projectile"
    PRINT "tests -- plug punched and plug almost punched ('started').  Assumed default"
    PRINT "shatter logic applied & projectile quality stayed the same for all of 1890s."
    PRINT "(5)  Changed pre-1911 default KC to Q = 0.787, from US retests with 12-inch"
    PRINT "Midvale 1916 projectiles of older 13.5-inch CKC plates.  BNC the same."

    PRINT "CONTINUE? (Y=Yes/N=Skip Rest (Any other entry does nothing)) ";

  CASE 5

'VERSION 7.5 & 7.6 & 7.7 & 7.8 CHANGES
    PRINT "VERSION 7.5 CHANGES:"
    PRINT "(1)  Corrected typo in variable "CARTWL" that was zeroing it when used there."
    PRINT "(2)  Corrected 13 typos in variable "ARMR" that also wrongly zeroed it there."
    PRINT "(3)  Put global variable "SHATVDFPR" into COMMON SHARED table where it needed"
    PRINT "to be.  This was also incorrectly zeroing it when used most of the time."
    PRINT "(4)  Added to REMARKS about decapping that some US Army APC shells used a"
    PRINT "high-temperature solder that required thicker 0.1605-caliber plates to decap"
    PRINT "& that Krupp caps used an even stronger form of that solder needing 0.23 cal."
    PRINT "(5)  Found more data on uncapped AP shells having nose-only shatter against"
    PRINT "thin KC-type plates at normal (new data shows this does not happen at OB=20"
    PRINT "deg nor against Qarmor = ~1.0 KC-type plate > 0.5 cal). Modified my logic for"
    PRINT "this to use the 'NSDAMAGL' (if > 0) proj parameter to allow this to happen at"
    PRINT "OB<=15 with MinV Complete Shatter=1+[1170 x sqr-root(NSDAMAGL/20) x COS(Ob)]."
    PRINT "THIS IS THE ONLY VERSION 7.6 CHANGE:"
    PRINT "Corrected logic error in new logic that had weak projectiles (PLIM<0.85) use"
    PRINT "Shattered Projectile Obliquity Curve for all HBL calculations, but not always"
    PRINT "for NBL calculations (weaker plates may allow regular NBL Obliquity effects)."
    PRINT "Regular NBL Obliquity Curve used if strongest armor or weakest projectiles."
    PRINT "Also caused program crash at 70 deg as well as giving wrong 'VHTRU' results."
    PRINT "THIS IS THE ONLY VERSION 7.7 CHANGE:
    PRINT "Projectile Deflection Logic for Japanese 155mm & 203mm TYPE 91 AP projectiles"
    PRINT "with Cap Head, but no AP Cap, was failing at any Obliquity between 0 & 15 deg"
    PRINT "because in that case shatter was occurring, but minimum deflection was zero,"
    PRINT "so the Deflection Angle formula tried to divide by zero, crashing program."  
    PRINT "VERSION 7.8 CHANGES:
    PRINT "(1)  For weaker armors against stronger shells, a Proj Quality Bonus 'PPLUS'"
    PRINT "is applied to reflect reduced damage; skipped if original Qproj = 1.00 & up."
    PRINT "Against all armors NOT giving such a bonus (toughest), the US PROJ SELECTION"
    PRINT "20 (best) proj under extreme conditions are no better than the next-best"
    PRINT "(US PROJ SELECTION 19) shells and I swapped 19 data for 20 data in logic, if"
    PRINT "so (special logic applied).  I forgot to swap data back for looped runs with"
    PRINT "a repeat US PROJ SELECTION 20 shell.  Fixed bug."
    PRINT "(2)  If the final HBL/NBL/EBL data page display uses a '-!#-' symbol, then"
    PRINT "that HBL or NBL is used for BOTH proj penetration AND post-impact damage"
    PRINT "condition determinations.  In the case of the shatter HBL, if the logic"
    PRINT "changed the HBL from '-!#-' for regular shatter to the best possible shatter"
    PRINT "result, I forgot in one place to clear the old regular display.  Fixed bug." 

    PRINT "CONTINUE? (Y=Yes/N=Skip Rest (Any other entry does nothing)) ";

  CASE 6

'THIS IS THE LAST CHANGE INFO PAGE

'VERSION 7.9 & 8.0 CHANGES
    PRINT "VERSION 7.9 CHANGES:"
    PRINT "(1)  When I previously updated the HARVEY & 19th-Century KC data, I failed to"
    PRINT "fix COMPOUND armor data to match, so I reduced 'Q' to 0.575 & 'QDAM' to 0.45."
    PRINT "These are the best values that I estimate from several conflicting sources."
    PRINT "(2)  I previously changed HARVEY armors to reduce their quality as thickness"
    PRINT "increases due to the thin face layer always being the same thickness. My data"
    PRINT "only goes up to 18 inches, so going much farther was not justified.  I have"
    PRINT "now put a 20 inch maximum in the formulae that lower both 'Q' and 'QDAM'."
'
    PRINT "VERSION 8.0 CHANGES:"
    PRINT "(1)  Krupp WWI tough-capped C/11 projectiles (German Projectile Selection #8)" 
    PRINT "finally has some ballistic test results for the 894-lb 12-in L/3.4 design, &"
    PRINT "it seems to be better than later hard-capped post-WWI L/3.7 design. I am not"
    PRINT "sure why this would be so, since the L/3.7 design, as found by US post-WWII"
    PRINT "studies and ballistic testing, was a very brittle design, lower in strength"
    PRINT "than the WWII L/4.4 design by a large margin. I assume that all C/11 shells"
    PRINT "are the same & have changed PLIM & modifers to match new 0 & 30 deg data."
    PRINT "Proj Pen Quality 'PLIM' changed from 0.794 to 0.877 (fixes 0 deg calc)."
    PRINT "Changed 'ALD/BLD/CLD' values for OB>0, but not current 'AED/BED/CED' values."
    PRINT "(2)  Changed min OB for shatter with tough or thin hard AP caps (APCAP=3)" 
    PRINT "from 20 to 30 deg against extra-tough (SOFTSHAT=1) armor with T/D > 0.67." 

'COMMENT OUT EITHER 'CONTINUE?' (ANOTHER INFO PAGE EXISTS) OR 'FINISHED?' (LAST PAGE) BELOW

'   PRINT "CONTINUE? (Y=Yes/N=Skip Rest (Any other entry does nothing)) ";
    PRINT "FINISHED? Y=Yes (Any other entry does nothing) ";

END SELECT

' ** END OF SUB VERSIONPRNT **

END SUB

SUB YESNO STATIC

' SET YES OR NO FLAG 'YS' DEPENDING ON USER INPUT

YSNO:
YS$ = INKEY$
IF ((YS$ <> "Y") AND (YS$ <> "y") AND (YS$ <> "N") AND (YS$ <> "n")) THEN GOTO YSNO: 'BAD INPUT
YS = 0: IF ((YS$ = "Y") OR (YS$ = "y")) THEN YS = 1: ''N'-->YS=0

' ** END OF SUB YESNO **

END SUB

'**** END OF FILE 'FH80SBM2.BAS' ****
